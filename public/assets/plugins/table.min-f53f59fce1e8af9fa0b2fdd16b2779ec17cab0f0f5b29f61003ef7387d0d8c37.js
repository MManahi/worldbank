!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),a(t)}:a(window.jQuery)}(function(_e){_e.extend(_e.FE.POPUP_TEMPLATES,{"table.insert":"[_BUTTONS_][_ROWS_COLUMNS_]","table.edit":"[_BUTTONS_]","table.colors":"[_BUTTONS_][_COLORS_][_CUSTOM_COLOR_]"}),_e.extend(_e.FE.DEFAULTS,{tableInsertMaxSize:10,tableEditButtons:["tableHeader","tableRemove","|","tableRows","tableColumns","tableStyle","-","tableCells","tableCellBackground","tableCellVerticalAlign","tableCellHorizontalAlign","tableCellStyle"],tableInsertButtons:["tableBack","|"],tableResizer:!0,tableResizerOffset:5,tableResizingLimit:30,tableColorsButtons:["tableBack","|"],tableColors:["#61BD6D","#1ABC9C","#54ACD2","#2C82C9","#9365B8","#475577","#CCCCCC","#41A85F","#00A885","#3D8EB9","#2969B0","#553982","#28324E","#000000","#F7DA64","#FBA026","#EB6B56","#E25041","#A38F84","#EFEFEF","#FFFFFF","#FAC51C","#F37934","#D14841","#B8312F","#7C706B","#D1D5D8","REMOVE"],tableColorsStep:7,tableCellStyles:{"fr-highlighted":"Highlighted","fr-thick":"Thick"},tableStyles:{"fr-dashed-borders":"Dashed Borders","fr-alternate-rows":"Alternate Rows"},tableCellMultipleStyles:!0,tableMultipleStyles:!0,tableInsertHelper:!0,tableInsertHelperOffset:15}),_e.FE.PLUGINS.table=function(E){function e(){var e=E.$tb.find('.fr-command[data-cmd="insertTable"]'),t=E.popups.get("table.insert");if(t||(t=s()),!t.hasClass("fr-active")){E.popups.refresh("table.insert"),E.popups.setContainer("table.insert",E.$tb);var a=e.offset().left+e.outerWidth()/2,l=e.offset().top+(E.opts.toolbarBottom?10:e.outerHeight()-10);E.popups.show("table.insert",a,l,e.outerHeight())}}function h(){var e=N();if(e){var t=E.popups.get("table.edit");if(t||(t=i()),t){E.popups.setContainer("table.edit",E.$sc);var a=H(e),l=(a.left+a.right)/2,n=a.bottom;E.popups.show("table.edit",l,n,a.bottom-a.top),E.edit.isDisabled()&&(E.toolbar.disable(),E.$el.removeClass("fr-no-selection"),E.edit.on(),E.button.bulkRefresh(),E.selection.setAtEnd(E.$el.find(".fr-selected-cell:last").get(0)),E.selection.restore())}}}function n(){var e=N();if(e){var t=E.popups.get("table.colors");t||(t=f()),E.popups.setContainer("table.colors",E.$sc);var a=H(e),l=(a.left+a.right)/2,n=a.bottom;u(),E.popups.show("table.colors",l,n,a.bottom-a.top)}}function l(){0===ve().length&&E.toolbar.enable()}function s(e){if(e)return E.popups.onHide("table.insert",function(){E.popups.get("table.insert").find('.fr-table-size .fr-select-table-size > span[data-row="1"][data-col="1"]').trigger("mouseenter")}),!0;var t="";0<E.opts.tableInsertButtons.length&&(t='<div class="fr-buttons">'+E.button.buildList(E.opts.tableInsertButtons)+"</div>");var a={buttons:t,rows_columns:r()},l=E.popups.create("table.insert",a);return E.events.$on(l,"mouseenter",".fr-table-size .fr-select-table-size .fr-table-cell",function(e){d(_e(e.currentTarget))},!0),o(l),l}function d(e){var t=e.data("row"),a=e.data("col"),l=e.parent();l.siblings(".fr-table-size-info").html(t+" &times; "+a),l.find("> span").removeClass("hover fr-active-item");for(var n=1;n<=E.opts.tableInsertMaxSize;n++)for(var s=0;s<=E.opts.tableInsertMaxSize;s++){var r=l.find('> span[data-row="'+n+'"][data-col="'+s+'"]');n<=t&&s<=a?r.addClass("hover"):n<=t+1||n<=2&&!E.helpers.isMobile()?r.css("display","inline-block"):2<n&&!E.helpers.isMobile()&&r.css("display","none")}e.addClass("fr-active-item")}function r(){for(var e='<div class="fr-table-size"><div class="fr-table-size-info">1 &times; 1</div><div class="fr-select-table-size">',t=1;t<=E.opts.tableInsertMaxSize;t++){for(var a=1;a<=E.opts.tableInsertMaxSize;a++){var l="inline-block";2<t&&!E.helpers.isMobile()&&(l="none");var n="fr-table-cell ";1==t&&1==a&&(n+=" hover"),e+='<span class="fr-command '+n+'" tabIndex="-1" data-cmd="tableInsert" data-row="'+t+'" data-col="'+a+'" data-param1="'+t+'" data-param2="'+a+'" style="display: '+l+';" role="button"><span></span><span class="fr-sr-only">'+t+" &times; "+a+"&nbsp;&nbsp;&nbsp;</span></span>"}e+='<div class="new-line"></div>'}return e+"</div></div>"}function o(e){E.events.$on(e,"focus","[tabIndex]",function(e){d(_e(e.currentTarget))}),E.events.on("popup.tab",function(e){var t=_e(e.currentTarget);if(!E.popups.isVisible("table.insert")||!t.is("span, a"))return!0;var a,l=e.which;if(_e.FE.KEYCODE.ARROW_UP==l||_e.FE.KEYCODE.ARROW_DOWN==l||_e.FE.KEYCODE.ARROW_LEFT==l||_e.FE.KEYCODE.ARROW_RIGHT==l){if(t.is("span.fr-table-cell")){var n=t.parent().find("span.fr-table-cell"),s=n.index(t),r=E.opts.tableInsertMaxSize,o=s%r,i=Math.floor(s/r);_e.FE.KEYCODE.ARROW_UP==l?i=Math.max(0,i-1):_e.FE.KEYCODE.ARROW_DOWN==l?i=Math.min(E.opts.tableInsertMaxSize-1,i+1):_e.FE.KEYCODE.ARROW_LEFT==l?o=Math.max(0,o-1):_e.FE.KEYCODE.ARROW_RIGHT==l&&(o=Math.min(E.opts.tableInsertMaxSize-1,o+1));var f=i*r+o,c=_e(n.get(f));d(c),E.events.disableBlur(),c.focus(),a=!1}}else _e.FE.KEYCODE.ENTER==l&&(E.button.exec(t),a=!1);return!1===a&&(e.preventDefault(),e.stopPropagation()),a},!0)}function i(e){if(e)return E.popups.onHide("table.edit",l),!0;if(0<E.opts.tableEditButtons.length){var t={buttons:'<div class="fr-buttons">'+E.button.buildList(E.opts.tableEditButtons)+"</div>"},a=E.popups.create("table.edit",t);return E.events.$on(E.$wp,"scroll.table-edit",function(){E.popups.isVisible("table.edit")&&h()}),a}return!1}function f(){var e="";0<E.opts.tableColorsButtons.length&&(e='<div class="fr-buttons fr-table-colors-buttons">'+E.button.buildList(E.opts.tableColorsButtons)+"</div>");var t="";E.opts.colorsHEXInput&&(t='<div class="fr-table-colors-hex-layer fr-active fr-layer" id="fr-table-colors-hex-layer-'+E.id+'"><div class="fr-input-line"><input maxlength="7" id="fr-table-colors-hex-layer-text-'+E.id+'" type="text" placeholder="'+E.language.translate("HEX Color")+'" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="tableCellBackgroundCustomColor" tabIndex="2" role="button">'+E.language.translate("OK")+"</button></div></div>");var a={buttons:e,colors:c(),custom_color:t},l=E.popups.create("table.colors",a);return E.events.$on(E.$wp,"scroll.table-colors",function(){E.popups.isVisible("table.colors")&&n()}),p(l),l}function c(){for(var e='<div class="fr-table-colors">',t=0;t<E.opts.tableColors.length;t++)0!==t&&t%E.opts.tableColorsStep==0&&(e+="<br>"),e+="REMOVE"!=E.opts.tableColors[t]?'<span class="fr-command" style="background: '+E.opts.tableColors[t]+';" tabIndex="-1" role="button" data-cmd="tableCellBackgroundColor" data-param1="'+E.opts.tableColors[t]+'"><span class="fr-sr-only">'+E.language.translate("Color")+" "+E.opts.tableColors[t]+"&nbsp;&nbsp;&nbsp;</span></span>":'<span class="fr-command" data-cmd="tableCellBackgroundColor" tabIndex="-1" role="button" data-param1="REMOVE" title="'+E.language.translate("Clear Formatting")+'">'+E.icon.create("tableColorRemove")+'<span class="fr-sr-only">'+E.language.translate("Clear Formatting")+"</span></span>";return e+"</div>"}function t(){var e=E.popups.get("table.colors").find(".fr-table-colors-hex-layer input");e.length&&_(e.val())}function p(h){E.events.on("popup.tab",function(e){var t=_e(e.currentTarget);if(!E.popups.isVisible("table.colors")||!t.is("span"))return!0;var a=e.which,l=!0;if(_e.FE.KEYCODE.TAB==a){var n=h.find(".fr-buttons");l=!E.accessibility.focusToolbar(n,!!e.shiftKey)}else if(_e.FE.KEYCODE.ARROW_UP==a||_e.FE.KEYCODE.ARROW_DOWN==a||_e.FE.KEYCODE.ARROW_LEFT==a||_e.FE.KEYCODE.ARROW_RIGHT==a){var s=t.parent().find("span.fr-command"),r=s.index(t),o=E.opts.colorsStep,i=Math.floor(s.length/o),f=r%o,c=Math.floor(r/o)*o+f,d=i*o;_e.FE.KEYCODE.ARROW_UP==a?c=((c-o)%d+d)%d:_e.FE.KEYCODE.ARROW_DOWN==a?c=(c+o)%d:_e.FE.KEYCODE.ARROW_LEFT==a?c=((c-1)%d+d)%d:_e.FE.KEYCODE.ARROW_RIGHT==a&&(c=(c+1)%d);var p=_e(s.get(c));E.events.disableBlur(),p.focus(),l=!1}else _e.FE.KEYCODE.ENTER==a&&(E.button.exec(t),l=!1);return!1===l&&(e.preventDefault(),e.stopPropagation()),l},!0)}function u(){var e=E.popups.get("table.colors"),t=E.$el.find(".fr-selected-cell:first"),a=E.helpers.RGBToHex(t.css("background-color")),l=e.find(".fr-table-colors-hex-layer input");e.find(".fr-selected-color").removeClass("fr-selected-color fr-active-item"),e.find('span[data-param1="'+a+'"]').addClass("fr-selected-color fr-active-item"),l.val(a).trigger("change")}function a(e,t){var a,l,n='<table style="width: 100%;" class="fr-inserted-table"><tbody>',s=100/t;for(a=0;a<e;a++){for(n+="<tr>",l=0;l<t;l++)n+='<td style="width: '+s.toFixed(4)+'%;">',0===a&&0===l&&(n+=_e.FE.MARKERS),n+="<br></td>";n+="</tr>"}n+="</tbody></table>",E.html.insert(n),E.selection.restore();var r=E.$el.find(".fr-inserted-table");r.removeClass("fr-inserted-table"),E.events.trigger("table.inserted",[r.get(0)])}function b(){if(0<ve().length){var e=we();E.selection.setBefore(e.get(0))||E.selection.setAfter(e.get(0)),E.selection.restore(),E.popups.hide("table.edit"),e.remove(),E.toolbar.enable()}}function g(){var e=we();if(0<e.length&&0===e.find("th").length){var t,a="<thead><tr>",l=0;for(e.find("tr:first > td").each(function(){var e=_e(this);l+=parseInt(e.attr("colspan"),10)||1}),t=0;t<l;t++)a+="<th><br></th>";a+="</tr></thead>",e.prepend(a),h()}}function m(){var e=we(),t=e.find("thead");if(0<t.length)if(0===e.find("tbody tr").length)b();else if(t.remove(),0<ve().length)h();else{E.popups.hide("table.edit");var a=e.find("tbody tr:first td:first").get(0);a&&(E.selection.setAtEnd(a),E.selection.restore())}}function v(e){var t=we();if(0<t.length){if(0<E.$el.find("th.fr-selected-cell").length&&"above"==e)return;var a,l,n,s=N(),r=K(s);l="above"==e?r.min_i:r.max_i;var o="<tr>";for(a=0;a<s[l].length;a++)if("below"==e&&l<s.length-1&&s[l][a]==s[l+1][a]||"above"==e&&0<l&&s[l][a]==s[l-1][a]){if(0===a||0<a&&s[l][a]!=s[l][a-1]){var i=_e(s[l][a]);i.attr("rowspan",parseInt(i.attr("rowspan"),10)+1)}}else o+="<td><br></td>";o+="</tr>",n=_e(0<E.$el.find("th.fr-selected-cell").length&&"below"==e?t.find("tbody").not(t.find("table tbody")):t.find("tr").not(t.find("table tr")).get(l)),"below"==e?"TBODY"==n.prop("tagName")?n.prepend(o):n.after(o):"above"==e&&(n.before(o),E.popups.isVisible("table.edit")&&h())}}function w(){var e=we();if(0<e.length){var t,a,l,n=N(),s=K(n);if(0===s.min_i&&s.max_i==n.length-1)b();else{for(t=s.max_i;t>=s.min_i;t--){for(l=_e(e.find("tr").not(e.find("table tr")).get(t)),a=0;a<n[t].length;a++)if(0===a||n[t][a]!=n[t][a-1]){var r=_e(n[t][a]);if(1<parseInt(r.attr("rowspan"),10)){var o=parseInt(r.attr("rowspan"),10)-1;1==o?r.removeAttr("rowspan"):r.attr("rowspan",o)}if(t<n.length-1&&n[t][a]==n[t+1][a]&&(0===t||n[t][a]!=n[t-1][a])){for(var i=n[t][a],f=a;0<f&&n[t][f]==n[t][f-1];)f--;0===f?_e(e.find("tr").not(e.find("table tr")).get(t+1)).prepend(i):_e(n[t+1][f-1]).after(i)}}var c=l.parent();l.remove(),0===c.find("tr").length&&c.remove(),n=N(e)}x(0,n.length-1,0,n[0].length-1,e),0<s.min_i?E.selection.setAtEnd(n[s.min_i-1][0]):E.selection.setAtEnd(n[0][0]),E.selection.restore(),E.popups.hide("table.edit")}}}function C(i){var e=we();if(0<e.length){var f,c=N(),t=K(c);f="before"==i?t.min_j:t.max_j;var a,d=100/c[0].length,p=100/(c[0].length+1);e.find("th, td").each(function(){(a=_e(this)).data("old-width",a.outerWidth()/e.outerWidth()*100)}),e.find("tr").not(e.find("table tr")).each(function(e){for(var t,a=_e(this),l=0,n=0;l-1<f;){if(!(t=a.find("> th, > td").get(n))){t=null;break}t==c[e][l]?(l+=parseInt(_e(t).attr("colspan"),10)||1,n++):(l+=parseInt(_e(c[e][l]).attr("colspan"),10)||1,"after"==i&&(t=0===n?-1:a.find("> th, > td").get(n-1)))}var s,r=_e(t);if("after"==i&&f<l-1||"before"==i&&0<f&&c[e][f]==c[e][f-1]){if(0===e||0<e&&c[e][f]!=c[e-1][f]){var o=parseInt(r.attr("colspan"),10)+1;r.attr("colspan",o),r.css("width",(r.data("old-width")*p/d+p).toFixed(4)+"%"),r.removeData("old-width")}}else s=0<a.find("th").length?'<th style="width: '+p.toFixed(4)+'%;"><br></th>':'<td style="width: '+p.toFixed(4)+'%;"><br></td>',-1==t?a.prepend(s):null==t?a.append(s):"before"==i?r.before(s):"after"==i&&r.after(s)}),e.find("th, td").each(function(){(a=_e(this)).data("old-width")&&(a.css("width",(a.data("old-width")*p/d).toFixed(4)+"%"),a.removeData("old-width"))}),E.popups.isVisible("table.edit")&&h()}}function R(){var e=we();if(0<e.length){var t,a,l,n=N(),s=K(n);if(0===s.min_j&&s.max_j==n[0].length-1)b();else{var r=100/n[0].length,o=100/(n[0].length-s.max_j+s.min_j-1);for(e.find("th, td").each(function(){(l=_e(this)).hasClass("fr-selected-cell")||l.data("old-width",l.outerWidth()/e.outerWidth()*100)}),a=s.max_j;a>=s.min_j;a--)for(t=0;t<n.length;t++)if(0===t||n[t][a]!=n[t-1][a])if(l=_e(n[t][a]),1<(parseInt(l.attr("colspan"),10)||1)){var i=parseInt(l.attr("colspan"),10)-1;1==i?l.removeAttr("colspan"):l.attr("colspan",i),l.css("width",((l.data("old-width")-ce(a,n))*o/r).toFixed(4)+"%"),l.removeData("old-width")}else{var f=_e(l.parent().get(0));l.remove(),0===f.find("> th, > td").length&&(0===f.prev().length||0===f.next().length||f.prev().find("> th[rowspan], > td[rowspan]").length<f.prev().find("> th, > td").length)&&f.remove()}x(0,n.length-1,0,n[0].length-1,e),0<s.min_j?E.selection.setAtEnd(n[s.min_i][s.min_j-1]):E.selection.setAtEnd(n[s.min_i][0]),E.selection.restore(),E.popups.hide("table.edit"),e.find("th, td").each(function(){(l=_e(this)).data("old-width")&&(l.css("width",(l.data("old-width")*o/r).toFixed(4)+"%"),l.removeData("old-width"))})}}}function O(e,t,a){var l,n,s,r,o,i=0,f=N(a);if(e<(t=Math.min(t,f[0].length-1)))for(n=e;n<=t;n++)if(!(e<n&&f[0][n]==f[0][n-1])&&(1<(r=Math.min(parseInt(f[0][n].getAttribute("colspan"),10)||1,t-e+1))&&f[0][n]==f[0][n+1]))for(i=r-1,l=1;l<f.length;l++)if(f[l][n]!=f[l-1][n]){for(s=n;s<n+r;s++)if(1<(o=parseInt(f[l][s].getAttribute("colspan"),10)||1)&&f[l][s]==f[l][s+1])s+=i=Math.min(i,o-1);else if(!(i=Math.max(0,i-1)))break;if(!i)break}i&&F(f,i,"colspan",0,f.length-1,e,t)}function A(e,t,a){var l,n,s,r,o,i=0,f=N(a);if(e<(t=Math.min(t,f.length-1)))for(l=e;l<=t;l++)if(!(e<l&&f[l][0]==f[l-1][0])&&(1<(r=Math.min(parseInt(f[l][0].getAttribute("rowspan"),10)||1,t-e+1))&&f[l][0]==f[l+1][0]))for(i=r-1,n=1;n<f[0].length;n++)if(f[l][n]!=f[l][n-1]){for(s=l;s<l+r;s++)if(1<(o=parseInt(f[s][n].getAttribute("rowspan"),10)||1)&&f[s][n]==f[s+1][n])s+=i=Math.min(i,o-1);else if(!(i=Math.max(0,i-1)))break;if(!i)break}i&&F(f,i,"rowspan",e,t,0,f[0].length-1)}function F(e,t,a,l,n,s,r){var o,i,f;for(o=l;o<=n;o++)for(i=s;i<=r;i++)l<o&&e[o][i]==e[o-1][i]||s<i&&e[o][i]==e[o][i-1]||1<(f=parseInt(e[o][i].getAttribute(a),10)||1)&&(1<f-t?e[o][i].setAttribute(a,f-t):e[o][i].removeAttribute(a))}function x(e,t,a,l,n){A(e,t,n),O(a,l,n)}function y(){if(1<ve().length&&(0===E.$el.find("th.fr-selected-cell").length||0===E.$el.find("td.fr-selected-cell").length)){B();var e,t,a=K(N()),l=E.$el.find(".fr-selected-cell"),n=_e(l[0]),s=n.parent().find(".fr-selected-cell"),r=n.closest("table"),o=n.html(),i=0;for(e=0;e<s.length;e++)i+=_e(s[e]).outerWidth();for(n.css("width",(i/r.outerWidth()*100).toFixed(4)+"%"),a.min_j<a.max_j&&n.attr("colspan",a.max_j-a.min_j+1),a.min_i<a.max_i&&n.attr("rowspan",a.max_i-a.min_i+1),e=1;e<l.length;e++)"<br>"!=(t=_e(l[e])).html()&&""!==t.html()&&(o+="<br>"+t.html()),t.remove();n.html(o),E.selection.setAtEnd(n.get(0)),E.selection.restore(),E.toolbar.enable(),A(a.min_i,a.max_i,r);var f=r.find("tr:empty");for(e=f.length-1;0<=e;e--)_e(f[e]).remove();O(a.min_j,a.max_j,r),h()}}function D(){if(1==ve().length){var e=E.$el.find(".fr-selected-cell"),t=e.parent(),a=e.closest("table"),l=parseInt(e.attr("rowspan"),10),n=N(),s=S(e.get(0),n),r=e.clone().html("<br>");if(1<l){var o=Math.ceil(l/2);1<o?e.attr("rowspan",o):e.removeAttr("rowspan"),1<l-o?r.attr("rowspan",l-o):r.removeAttr("rowspan");for(var i=s.row+o,f=0===s.col?s.col:s.col-1;0<=f&&(n[i][f]==n[i][f-1]||0<i&&n[i][f]==n[i-1][f]);)f--;-1==f?_e(a.find("tr").not(a.find("table tr")).get(i)).prepend(r):_e(n[i][f]).after(r)}else{var c,d=_e("<tr>").append(r);for(c=0;c<n[0].length;c++)if(0===c||n[s.row][c]!=n[s.row][c-1]){var p=_e(n[s.row][c]);p.is(e)||p.attr("rowspan",(parseInt(p.attr("rowspan"),10)||1)+1)}t.after(d)}k(),E.popups.hide("table.edit")}}function $(){if(1==ve().length){var e=E.$el.find(".fr-selected-cell"),t=parseInt(e.attr("colspan"),10)||1,a=e.parent().outerWidth(),l=e.outerWidth(),n=e.clone().html("<br>"),s=N(),r=S(e.get(0),s);if(1<t){var o=Math.ceil(t/2);l=de(r.col,r.col+o-1,s)/a*100;var i=de(r.col+o,r.col+t-1,s)/a*100;1<o?e.attr("colspan",o):e.removeAttr("colspan"),1<t-o?n.attr("colspan",t-o):n.removeAttr("colspan"),e.css("width",l.toFixed(4)+"%"),n.css("width",i.toFixed(4)+"%")}else{var f;for(f=0;f<s.length;f++)if(0===f||s[f][r.col]!=s[f-1][r.col]){var c=_e(s[f][r.col]);if(!c.is(e)){var d=(parseInt(c.attr("colspan"),10)||1)+1;c.attr("colspan",d)}}l=l/a*100/2,e.css("width",l.toFixed(4)+"%"),n.css("width",l.toFixed(4)+"%")}e.after(n),k(),E.popups.hide("table.edit")}}function _(e){var t=E.$el.find(".fr-selected-cell");"REMOVE"!=e?t.css("background-color",E.helpers.HEXtoRGB(e)):t.css("background-color",""),h()}function M(e){E.$el.find(".fr-selected-cell").css("vertical-align",e)}function I(e){E.$el.find(".fr-selected-cell").css("text-align",e)}function T(e,t,a,l){if(0<t.length){if(!a){var n=Object.keys(l);n.splice(n.indexOf(e),1),t.removeClass(n.join(" "))}t.toggleClass(e)}}function N(e){var f=[];return null==(e=e||null)&&0<ve().length&&(e=we()),e&&e.find("tr").not(e.find("table tr")).each(function(o,e){var t=_e(e),i=0;t.find("> th, > td").each(function(e,t){for(var a=_e(t),l=parseInt(a.attr("colspan"),10)||1,n=parseInt(a.attr("rowspan"),10)||1,s=o;s<o+n;s++)for(var r=i;r<i+l;r++)f[s]||(f[s]=[]),f[s][r]?i++:f[s][r]=t;i+=l})}),f}function S(e,t){for(var a=0;a<t.length;a++)for(var l=0;l<t[a].length;l++)if(t[a][l]==e)return{row:a,col:l}}function z(e,t,a){for(var l=e+1,n=t+1;l<a.length;){if(a[l][t]!=a[e][t]){l--;break}l++}for(l==a.length&&l--;n<a[e].length;){if(a[e][n]!=a[e][t]){n--;break}n++}return n==a[e].length&&n--,{row:l,col:n}}function B(){E.el.querySelector(".fr-cell-fixed")&&E.el.querySelector(".fr-cell-fixed").classList.remove("fr-cell-fixed"),E.el.querySelector(".fr-cell-handler")&&E.el.querySelector(".fr-cell-handler").classList.remove("fr-cell-handler")}function k(){var e=E.$el.find(".fr-selected-cell");0<e.length&&e.each(function(){var e=_e(this);e.removeClass("fr-selected-cell"),""===e.attr("class")&&e.removeAttr("class")}),B()}function W(){E.events.disableBlur(),E.selection.clear(),E.$el.addClass("fr-no-selection"),E.$el.blur(),E.events.enableBlur()}function K(e){var t=E.$el.find(".fr-selected-cell");if(0<t.length){var a,l=e.length,n=0,s=e[0].length,r=0;for(a=0;a<t.length;a++){var o=S(t[a],e),i=z(o.row,o.col,e);l=Math.min(o.row,l),n=Math.max(i.row,n),s=Math.min(o.col,s),r=Math.max(i.col,r)}return{min_i:l,max_i:n,min_j:s,max_j:r}}return null}function L(e,t,a,l,n){var s,r,o,i,f=e,c=t,d=a,p=l;for(s=f;s<=c;s++)(1<(parseInt(_e(n[s][d]).attr("rowspan"),10)||1)||1<(parseInt(_e(n[s][d]).attr("colspan"),10)||1))&&(i=z((o=S(n[s][d],n)).row,o.col,n),f=Math.min(o.row,f),c=Math.max(i.row,c),d=Math.min(o.col,d),p=Math.max(i.col,p)),(1<(parseInt(_e(n[s][p]).attr("rowspan"),10)||1)||1<(parseInt(_e(n[s][p]).attr("colspan"),10)||1))&&(i=z((o=S(n[s][p],n)).row,o.col,n),f=Math.min(o.row,f),c=Math.max(i.row,c),d=Math.min(o.col,d),p=Math.max(i.col,p));for(r=d;r<=p;r++)(1<(parseInt(_e(n[f][r]).attr("rowspan"),10)||1)||1<(parseInt(_e(n[f][r]).attr("colspan"),10)||1))&&(i=z((o=S(n[f][r],n)).row,o.col,n),f=Math.min(o.row,f),c=Math.max(i.row,c),d=Math.min(o.col,d),p=Math.max(i.col,p)),(1<(parseInt(_e(n[c][r]).attr("rowspan"),10)||1)||1<(parseInt(_e(n[c][r]).attr("colspan"),10)||1))&&(i=z((o=S(n[c][r],n)).row,o.col,n),f=Math.min(o.row,f),c=Math.max(i.row,c),d=Math.min(o.col,d),p=Math.max(i.col,p));return f==e&&c==t&&d==a&&p==l?{min_i:e,max_i:t,min_j:a,max_j:l}:L(f,c,d,p,n)}function H(e){var t=K(e),a=_e(e[t.min_i][t.min_j]),l=_e(e[t.min_i][t.max_j]),n=_e(e[t.max_i][t.min_j]);return{left:a.offset().left,right:l.offset().left+l.outerWidth(),top:a.offset().top,bottom:n.offset().top+n.outerHeight()}}function Y(e,t){if(_e(e).is(t))k(),E.edit.on(),_e(e).addClass("fr-selected-cell");else{W(),E.edit.off();var a=N(),l=S(e,a),n=S(t,a),s=L(Math.min(l.row,n.row),Math.max(l.row,n.row),Math.min(l.col,n.col),Math.max(l.col,n.col),a);k(),e.classList.add("fr-cell-fixed"),t.classList.add("fr-cell-handler");for(var r=s.min_i;r<=s.max_i;r++)for(var o=s.min_j;o<=s.max_j;o++)_e(a[r][o]).addClass("fr-selected-cell")}}function P(e){var t=null,a=_e(e.target);return"TD"==e.target.tagName||"TH"==e.target.tagName?t=e.target:0<a.closest("td").length?t=a.closest("td").get(0):0<a.closest("th").length&&(t=a.closest("th").get(0)),0===E.$el.find(t).length?null:t}function j(){k(),E.popups.hide("table.edit")}function V(e){var t=P(e);if("false"==_e(t).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable"))return!0;if(0<ve().length&&!t&&j(),!E.edit.isDisabled()||E.popups.isVisible("table.edit"))if(1!=e.which||1==e.which&&E.helpers.isMac()&&e.ctrlKey)(3==e.which||1==e.which&&E.helpers.isMac()&&e.ctrlKey)&&t&&j();else if(xe=!0,t){0<ve().length&&!e.shiftKey&&j(),e.stopPropagation(),E.events.trigger("image.hideResizer"),E.events.trigger("video.hideResizer"),Fe=!0;var a=t.tagName.toLowerCase();e.shiftKey&&0<E.$el.find(a+".fr-selected-cell").length?_e(E.$el.find(a+".fr-selected-cell").closest("table")).is(_e(t).closest("table"))?Y(ye,t):W():((E.keys.ctrlKey(e)||e.shiftKey)&&(1<ve().length||0===_e(t).find(E.selection.element()).length&&!_e(t).is(E.selection.element()))&&W(),Y(ye=t,ye))}}function X(e){if(Fe||E.$tb.is(e.target)||E.$tb.is(_e(e.target).closest(E.$tb.get(0)))||(0<ve().length&&E.toolbar.enable(),k()),!(1!=e.which||1==e.which&&E.helpers.isMac()&&e.ctrlKey)){if(xe=!1,Fe)Fe=!1,P(e)||1!=ve().length?0<ve().length&&(E.selection.isCollapsed()?h():k()):k();if($e){$e=!1,Oe.removeClass("fr-moving"),E.$el.removeClass("fr-no-selection"),E.edit.on();var t=parseFloat(Oe.css("left"))+E.opts.tableResizerOffset+E.$wp.offset().left;E.opts.iframe&&(t-=E.$iframe.offset().left),Oe.data("release-position",t),Oe.removeData("max-left"),Oe.removeData("max-right"),fe(e),te()}}}function U(e){if(!0===Fe){if(_e(e.currentTarget).closest("table").is(we())){if("TD"==e.currentTarget.tagName&&0===E.$el.find("th.fr-selected-cell").length)return void Y(ye,e.currentTarget);if("TH"==e.currentTarget.tagName&&0===E.$el.find("td.fr-selected-cell").length)return void Y(ye,e.currentTarget)}W()}}function q(e,t){for(var a=e;a&&"TABLE"!=a.tagName&&a.parentNode!=E.el;)a=a.parentNode;if(a&&"TABLE"==a.tagName){var l=N(_e(a));"up"==t?J(S(e,l),a,l):"down"==t&&Q(S(e,l),a,l)}}function G(e,t,a,l){for(var n,s=t;s!=E.el&&"TD"!=s.tagName&&"TH"!=s.tagName&&("up"==l?n=s.previousElementSibling:"down"==l&&(n=s.nextElementSibling),!n);)s=s.parentNode;"TD"==s.tagName||"TH"==s.tagName?q(s,l):n&&("up"==l&&E.selection.setAtEnd(n),"down"==l&&E.selection.setAtStart(n))}function J(e,t,a){0<e.row?E.selection.setAtEnd(a[e.row-1][e.col]):G(e,t,a,"up")}function Q(e,t,a){var l=parseInt(a[e.row][e.col].getAttribute("rowspan"),10)||1;e.row<a.length-l?E.selection.setAtStart(a[e.row+l][e.col]):G(e,t,a,"down")}function Z(e){var t=e.which,a=E.selection.blocks();if(a.length&&("TD"==(a=a[0]).tagName||"TH"==a.tagName)){for(var l=a;l&&"TABLE"!=l.tagName&&l.parentNode!=E.el;)l=l.parentNode;if(l&&"TABLE"==l.tagName&&(_e.FE.KEYCODE.ARROW_LEFT==t||_e.FE.KEYCODE.ARROW_UP==t||_e.FE.KEYCODE.ARROW_RIGHT==t||_e.FE.KEYCODE.ARROW_DOWN==t)&&(0<ve().length&&j(),E.browser.webkit&&(_e.FE.KEYCODE.ARROW_UP==t||_e.FE.KEYCODE.ARROW_DOWN==t))){var n=E.selection.ranges(0).startContainer;if(n.nodeType==Node.TEXT_NODE&&(_e.FE.KEYCODE.ARROW_UP==t&&n.previousSibling||_e.FE.KEYCODE.ARROW_DOWN==t&&n.nextSibling))return;e.preventDefault(),e.stopPropagation();var s=N(_e(l)),r=S(a,s);return _e.FE.KEYCODE.ARROW_UP==t?J(r,l,s):_e.FE.KEYCODE.ARROW_DOWN==t&&Q(r,l,s),E.selection.restore(),!1}}}function ee(){E.shared.$table_resizer||(E.shared.$table_resizer=_e('<div class="fr-table-resizer"><div></div></div>')),Oe=E.shared.$table_resizer,E.events.$on(Oe,"mousedown",function(e){return!E.core.sameInstance(Oe)||(0<ve().length&&j(),1==e.which?(E.selection.save(),$e=!0,Oe.addClass("fr-moving"),W(),E.edit.off(),Oe.find("div").css("opacity",1),!1):void 0)}),E.events.$on(Oe,"mousemove",function(e){return!E.core.sameInstance(Oe)||void($e&&(E.opts.iframe&&(e.pageX-=E.$iframe.offset().left),pe(e)))}),E.events.on("shared.destroy",function(){Oe.html("").removeData().remove(),Oe=null},!0),E.events.on("destroy",function(){E.$el.find(".fr-selected-cell").removeClass("fr-selected-cell"),Oe.hide().appendTo(_e("body:first"))},!0)}function te(){Oe&&(Oe.find("div").css("opacity",0),Oe.css("top",0),Oe.css("left",0),Oe.css("height",0),Oe.find("div").css("height",0),Oe.hide())}function ae(){Ae&&Ae.removeClass("fr-visible").css("left","-9999px")}function le(e,t){var a=_e(t),l=a.closest("table"),n=l.parent();if(t&&"TD"!=t.tagName&&"TH"!=t.tagName&&(0<a.closest("td").length?t=a.closest("td"):0<a.closest("th").length&&(t=a.closest("th"))),!t||"TD"!=t.tagName&&"TH"!=t.tagName)Oe&&a.get(0)!=Oe.get(0)&&a.parent().get(0)!=Oe.get(0)&&E.core.sameInstance(Oe)&&te();else{if(a=_e(t),0===E.$el.find(a).length)return!1;var s=a.offset().left-1,r=s+a.outerWidth();if(Math.abs(e.pageX-s)<=E.opts.tableResizerOffset||Math.abs(r-e.pageX)<=E.opts.tableResizerOffset){var o,i,f,c,d,p=N(l),h=S(t,p),u=z(h.row,h.col,p),b=l.offset().top,g=l.outerHeight()-1;"rtl"!=E.opts.direction?e.pageX-s<=E.opts.tableResizerOffset?(f=s,0<h.col?(c=s-ce(h.col-1,p)+E.opts.tableResizingLimit,d=s+ce(h.col,p)-E.opts.tableResizingLimit,o=h.col-1,i=h.col):(o=null,i=0,c=l.offset().left-1-parseInt(l.css("margin-left"),10),d=l.offset().left-1+l.width()-p[0].length*E.opts.tableResizingLimit)):r-e.pageX<=E.opts.tableResizerOffset&&(f=r,u.col<p[u.row].length&&p[u.row][u.col+1]?(c=r-ce(u.col,p)+E.opts.tableResizingLimit,d=r+ce(u.col+1,p)-E.opts.tableResizingLimit,o=u.col,i=u.col+1):(o=u.col,i=null,c=l.offset().left-1+p[0].length*E.opts.tableResizingLimit,d=n.offset().left-1+n.width()+parseFloat(n.css("padding-left")))):r-e.pageX<=E.opts.tableResizerOffset?(f=r,0<h.col?(c=r-ce(h.col,p)+E.opts.tableResizingLimit,d=r+ce(h.col-1,p)-E.opts.tableResizingLimit,o=h.col,i=h.col-1):(o=null,i=0,c=l.offset().left+p[0].length*E.opts.tableResizingLimit,d=n.offset().left-1+n.width()+parseFloat(n.css("padding-left")))):e.pageX-s<=E.opts.tableResizerOffset&&(f=s,u.col<p[u.row].length&&p[u.row][u.col+1]?(c=s-ce(u.col+1,p)+E.opts.tableResizingLimit,d=s+ce(u.col,p)-E.opts.tableResizingLimit,o=u.col+1,i=u.col):(o=u.col,i=null,c=n.offset().left+parseFloat(n.css("padding-left")),d=l.offset().left-1+l.width()-p[0].length*E.opts.tableResizingLimit)),Oe||ee(),Oe.data("table",l),Oe.data("first",o),Oe.data("second",i),Oe.data("instance",E),E.$wp.append(Oe);var m=f-E.win.pageXOffset-E.opts.tableResizerOffset-E.$wp.offset().left,v=b-E.$wp.offset().top+E.$wp.scrollTop();E.opts.iframe&&(m+=E.$iframe.offset().left,v+=E.$iframe.offset().top,c+=E.$iframe.offset().left,d+=E.$iframe.offset().left),Oe.data("max-left",c),Oe.data("max-right",d),Oe.data("origin",f-E.win.pageXOffset),Oe.css("top",v),Oe.css("left",m),Oe.css("height",g),Oe.find("div").css("height",g),Oe.css("padding-left",E.opts.tableResizerOffset),Oe.css("padding-right",E.opts.tableResizerOffset),Oe.show()}else E.core.sameInstance(Oe)&&te()}}function ne(e,t){if(E.$box.find(".fr-line-breaker").is(":visible"))return!1;Ae||be(),E.$box.append(Ae),Ae.data("instance",E);var a,l=_e(t).find("tr:first"),n=e.pageX,s=0,r=0;E.opts.iframe&&(s+=E.$iframe.offset().left-E.helpers.scrollLeft(),r+=E.$iframe.offset().top-E.helpers.scrollTop()),l.find("th, td").each(function(){var e=_e(this);return e.offset().left<=n&&n<e.offset().left+e.outerWidth()/2?(a=parseInt(Ae.find("a").css("width"),10),Ae.css("top",r+e.offset().top-E.$box.offset().top-E.win.pageYOffset-a-5),Ae.css("left",s+e.offset().left-E.$box.offset().left-E.win.pageXOffset-a/2),Ae.data("selected-cell",e),Ae.data("position","before"),Ae.addClass("fr-visible"),!1):e.offset().left+e.outerWidth()/2<=n&&n<e.offset().left+e.outerWidth()?(a=parseInt(Ae.find("a").css("width"),10),Ae.css("top",r+e.offset().top-E.$box.offset().top-E.win.pageYOffset-a-5),Ae.css("left",s+e.offset().left-E.$box.offset().left+e.outerWidth()-E.win.pageXOffset-a/2),Ae.data("selected-cell",e),Ae.data("position","after"),Ae.addClass("fr-visible"),!1):void 0})}function se(e,t){if(E.$box.find(".fr-line-breaker").is(":visible"))return!1;Ae||be(),E.$box.append(Ae),Ae.data("instance",E);var a,l=_e(t),n=e.pageY,s=0,r=0;E.opts.iframe&&(s+=E.$iframe.offset().left-E.helpers.scrollLeft(),r+=E.$iframe.offset().top-E.helpers.scrollTop()),l.find("tr").each(function(){var e=_e(this);return e.offset().top<=n&&n<e.offset().top+e.outerHeight()/2?(a=parseInt(Ae.find("a").css("width"),10),Ae.css("top",r+e.offset().top-E.$box.offset().top-E.win.pageYOffset-a/2),Ae.css("left",s+e.offset().left-E.$box.offset().left-E.win.pageXOffset-a-5),Ae.data("selected-cell",e.find("td:first")),Ae.data("position","above"),Ae.addClass("fr-visible"),!1):e.offset().top+e.outerHeight()/2<=n&&n<e.offset().top+e.outerHeight()?(a=parseInt(Ae.find("a").css("width"),10),Ae.css("top",r+e.offset().top-E.$box.offset().top+e.outerHeight()-E.win.pageYOffset-a/2),Ae.css("left",s+e.offset().left-E.$box.offset().left-E.win.pageXOffset-a-5),Ae.data("selected-cell",e.find("td:first")),Ae.data("position","below"),Ae.addClass("fr-visible"),!1):void 0})}function re(e,t){if(0===ve().length){var a,l,n;if(t&&("HTML"==t.tagName||"BODY"==t.tagName||E.node.isElement(t)))for(a=1;a<=E.opts.tableInsertHelperOffset;a++){if(l=E.doc.elementFromPoint(e.pageX-E.win.pageXOffset,e.pageY-E.win.pageYOffset+a),_e(l).hasClass("fr-tooltip"))return!0;if(l&&("TH"==l.tagName||"TD"==l.tagName||"TABLE"==l.tagName)&&(_e(l).parents(".fr-wrapper").length||E.opts.iframe))return ne(e,_e(l).closest("table")),!0;if(n=E.doc.elementFromPoint(e.pageX-E.win.pageXOffset+a,e.pageY-E.win.pageYOffset),_e(n).hasClass("fr-tooltip"))return!0;if(n&&("TH"==n.tagName||"TD"==n.tagName||"TABLE"==n.tagName)&&(_e(n).parents(".fr-wrapper").length||E.opts.iframe))return se(e,_e(n).closest("table")),!0}E.core.sameInstance(Ae)&&ae()}}function oe(e){De=null;var t=E.doc.elementFromPoint(e.pageX-E.win.pageXOffset,e.pageY-E.win.pageYOffset);E.opts.tableResizer&&(!E.popups.areVisible()||E.popups.areVisible()&&E.popups.isVisible("table.edit"))&&le(e,t),!E.opts.tableInsertHelper||E.popups.areVisible()||E.$tb.hasClass("fr-inline")&&E.$tb.is(":visible")||re(e,t)}function ie(){if($e){var e=Oe.data("table").offset().top-E.win.pageYOffset;E.opts.iframe&&(e+=E.$iframe.offset().top-E.helpers.scrollTop()),Oe.css("top",e)}}function fe(){var e=Oe.data("origin"),t=Oe.data("release-position");if(e!==t){var a=Oe.data("first"),l=Oe.data("second"),n=Oe.data("table"),s=n.outerWidth();if(E.undo.canDo()||E.undo.saveStep(),null!==a&&null!==l){var r,o,i,f=N(n),c=[],d=[],p=[],h=[];for(r=0;r<f.length;r++)o=_e(f[r][a]),i=_e(f[r][l]),c[r]=o.outerWidth(),p[r]=i.outerWidth(),d[r]=c[r]/s*100,h[r]=p[r]/s*100;for(r=0;r<f.length;r++){o=_e(f[r][a]),i=_e(f[r][l]);var u=(d[r]*(c[r]+t-e)/c[r]).toFixed(4);o.css("width",u+"%"),i.css("width",(d[r]+h[r]-u).toFixed(4)+"%")}}else{var b,g=n.parent(),m=s/g.width()*100,v=(parseInt(n.css("margin-left"),10)||0)/g.width()*100,w=(parseInt(n.css("margin-right"),10)||0)/g.width()*100;"rtl"==E.opts.direction&&0===l||"rtl"!=E.opts.direction&&0!==l?(b=(s+t-e)/s*m,n.css("margin-right","calc(100% - "+Math.round(b).toFixed(4)+"% - "+Math.round(v).toFixed(4)+"%)")):("rtl"==E.opts.direction&&0!==l||"rtl"!=E.opts.direction&&0===l)&&(b=(s-t+e)/s*m,n.css("margin-left","calc(100% - "+Math.round(b).toFixed(4)+"% - "+Math.round(w).toFixed(4)+"%)")),n.css("width",Math.round(b).toFixed(4)+"%")}E.selection.restore(),E.undo.saveStep()}Oe.removeData("origin"),Oe.removeData("release-position"),Oe.removeData("first"),Oe.removeData("second"),Oe.removeData("table")}function ce(e,t){var a,l=_e(t[0][e]).outerWidth();for(a=1;a<t.length;a++)l=Math.min(l,_e(t[a][e]).outerWidth());return l}function de(e,t,a){var l,n=0;for(l=e;l<=t;l++)n+=ce(l,a);return n}function pe(e){if(1<ve().length&&xe&&W(),!1===xe&&!1===Fe&&!1===$e)De&&clearTimeout(De),(!E.edit.isDisabled()||E.popups.isVisible("table.edit"))&&(De=setTimeout(oe,30,e));else if($e){var t=e.pageX-E.win.pageXOffset;E.opts.iframe&&(t+=E.$iframe.offset().left);var a=Oe.data("max-left"),l=Oe.data("max-right")
;a<=t&&t<=l?Oe.css("left",t-E.opts.tableResizerOffset-E.$wp.offset().left):t<a&&parseFloat(Oe.css("left"),10)>a-E.opts.tableResizerOffset?Oe.css("left",a-E.opts.tableResizerOffset-E.$wp.offset().left):l<t&&parseFloat(Oe.css("left"),10)<l-E.opts.tableResizerOffset&&Oe.css("left",l-E.opts.tableResizerOffset-E.$wp.offset().left)}else xe&&ae()}function he(e){E.node.isEmpty(e.get(0))?e.prepend(_e.FE.MARKERS):e.prepend(_e.FE.START_MARKER).append(_e.FE.END_MARKER)}function ue(e){if(e.which==_e.FE.KEYCODE.TAB){var t;if(0<ve().length)t=E.$el.find(".fr-selected-cell:last");else{var a=E.selection.element();"TD"==a.tagName||"TH"==a.tagName?t=_e(a):a!=E.el&&(0<_e(a).parentsUntil(E.$el,"td").length?t=_e(a).parents("td:first"):0<_e(a).parentsUntil(E.$el,"th").length&&(t=_e(a).parents("th:first")))}if(t)return e.preventDefault(),!!(0<_e(E.selection.element()).parents("ol, ul").length&&(0<_e(E.selection.element()).parents("li").prev().length||_e(E.selection.element()).is("li")&&0<_e(E.selection.element()).prev().length))||(j(),e.shiftKey?0<t.prev().length?he(t.prev()):0<t.closest("tr").length&&0<t.closest("tr").prev().length?he(t.closest("tr").prev().find("td:last")):0<t.closest("tbody").length&&0<t.closest("table").find("thead tr").length&&he(t.closest("table").find("thead tr th:last")):0<t.next().length?he(t.next()):0<t.closest("tr").length&&0<t.closest("tr").next().length?he(t.closest("tr").next().find("td:first")):0<t.closest("thead").length&&0<t.closest("table").find("tbody tr").length?he(t.closest("table").find("tbody tr td:first")):(t.addClass("fr-selected-cell"),v("below"),k(),he(t.closest("tr").next().find("td:first"))),E.selection.restore(),!1)}}function be(){E.shared.$ti_helper||(E.shared.$ti_helper=_e('<div class="fr-insert-helper"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+E.language.translate("Insert")+'"><svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/></svg></a></div>'),E.events.bindClick(E.shared.$ti_helper,"a",function(){var e=Ae.data("selected-cell"),t=Ae.data("position"),a=Ae.data("instance")||E;"before"==t?(E.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertColumn(t),e.removeClass("fr-selected-cell"),E.undo.saveStep()):"after"==t?(E.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertColumn(t),e.removeClass("fr-selected-cell"),E.undo.saveStep()):"above"==t?(E.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertRow(t),e.removeClass("fr-selected-cell"),E.undo.saveStep()):"below"==t&&(E.undo.saveStep(),e.addClass("fr-selected-cell"),a.table.insertRow(t),e.removeClass("fr-selected-cell"),E.undo.saveStep()),ae()}),E.events.on("shared.destroy",function(){E.shared.$ti_helper.html("").removeData().remove(),E.shared.$ti_helper=null},!0),E.events.$on(E.shared.$ti_helper,"mousemove",function(e){e.stopPropagation()},!0),E.events.$on(_e(E.o_win),"scroll",function(){ae()},!0),E.events.$on(E.$wp,"scroll",function(){ae()},!0)),Ae=E.shared.$ti_helper,E.events.on("destroy",function(){Ae=null}),E.tooltip.bind(E.$box,".fr-insert-helper > a.fr-floating-btn")}function ge(){ye=null,clearTimeout(De)}function me(){0<ve().length?h():(E.popups.hide("table.insert"),E.toolbar.showInline())}function ve(){return E.el.querySelectorAll(".fr-selected-cell")}function we(){var e=ve();if(e.length){for(var t=e[0];t&&"TABLE"!=t.tagName&&t.parentNode!=E.el;)t=t.parentNode;return _e(t&&"TABLE"==t.tagName?t:[])}return _e([])}function Ee(e){if(e.altKey&&e.which==_e.FE.KEYCODE.SPACE){var t,a=E.selection.element();if("TD"==a.tagName||"TH"==a.tagName?t=a:0<_e(a).closest("td").length?t=_e(a).closest("td").get(0):0<_e(a).closest("th").length&&(t=_e(a).closest("th").get(0)),t)return e.preventDefault(),Y(t,t),h(),!1}}function Ce(e){var t=ve();if(0<t.length){var a,l,n=N(),s=e.which;1==t.length?l=a=t[0]:(a=E.el.querySelector(".fr-cell-fixed"),l=E.el.querySelector(".fr-cell-handler"));var r=S(l,n);if(_e.FE.KEYCODE.ARROW_RIGHT==s){if(r.col<n[0].length-1)return Y(a,n[r.row][r.col+1]),!1}else if(_e.FE.KEYCODE.ARROW_DOWN==s){if(r.row<n.length-1)return Y(a,n[r.row+1][r.col]),!1}else if(_e.FE.KEYCODE.ARROW_LEFT==s){if(0<r.col)return Y(a,n[r.row][r.col-1]),!1}else if(_e.FE.KEYCODE.ARROW_UP==s&&0<r.row)return Y(a,n[r.row-1][r.col]),!1}}function Re(){if(!E.$wp)return!1;if(!E.helpers.isMobile()){$e=Fe=xe=!1,E.events.$on(E.$el,"mousedown",V),E.popups.onShow("image.edit",function(){k(),Fe=xe=!1}),E.popups.onShow("link.edit",function(){k(),Fe=xe=!1}),E.events.on("commands.mousedown",function(e){0<e.parents(".fr-toolbar").length&&k()}),E.events.$on(E.$el,"mouseenter","th, td",U),E.events.$on(E.$win,"mouseup",X),E.opts.iframe&&E.events.$on(_e(E.o_win),"mouseup",X),E.events.$on(E.$win,"mousemove",pe),E.events.$on(_e(E.o_win),"scroll",ie),E.events.on("contentChanged",function(){0<ve().length&&(h(),E.$el.find("img").on("load.selected-cells",function(){_e(this).off("load.selected-cells"),0<ve().length&&h()}))}),E.events.$on(_e(E.o_win),"resize",function(){k()}),E.events.on("toolbar.esc",function(){return 0<ve().length?(E.events.disableBlur(),E.events.focus(),!1):void 0},!0),E.events.$on(_e(E.o_win),"keydown",function(){xe&&Fe&&(Fe=xe=!1,E.$el.removeClass("fr-no-selection"),E.edit.on(),E.selection.setAtEnd(E.$el.find(".fr-selected-cell:last").get(0)),E.selection.restore(),k())}),E.events.$on(E.$el,"keydown",function(e){e.shiftKey?!1===Ce(e)&&setTimeout(function(){h()},0):Z(e)}),E.events.on("keydown",function(e){if(!1===ue(e))return!1;var t=ve();if(0<t.length){if(0<t.length&&E.keys.ctrlKey(e)&&e.which==_e.FE.KEYCODE.A)return k(),E.popups.isVisible("table.edit")&&E.popups.hide("table.edit"),t=[],!0;if(e.which==_e.FE.KEYCODE.ESC&&E.popups.isVisible("table.edit"))return k(),E.popups.hide("table.edit"),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),t=[],!1;if(1<t.length&&(e.which==_e.FE.KEYCODE.BACKSPACE||e.which==_e.FE.KEYCODE.DELETE)){E.undo.saveStep();for(var a=0;a<t.length;a++)_e(t[a]).html("<br>"),a==t.length-1&&_e(t[a]).prepend(_e.FE.MARKERS);return E.selection.restore(),E.undo.saveStep(),t=[],!1}if(1<t.length&&e.which!=_e.FE.KEYCODE.F10&&!E.keys.isBrowserAction(e))return e.preventDefault(),t=[],!1}else if(t=[],!1===Ee(e))return!1},!0);var t=[];E.events.on("html.beforeGet",function(){t=ve();for(var e=0;e<t.length;e++)t[e].className=(t[e].className||"").replace(/fr-selected-cell/g,"")}),E.events.on("html.afterGet",function(){for(var e=0;e<t.length;e++)t[e].className=(t[e].className?t[e].className.trim()+" ":"")+"fr-selected-cell";t=[]}),s(!0),i(!0)}E.events.on("destroy",ge)}var Oe,Ae,Fe,xe,ye,De,$e;return{_init:Re,insert:a,remove:b,insertRow:v,deleteRow:w,insertColumn:C,deleteColumn:R,mergeCells:y,splitCellVertically:$,splitCellHorizontally:D,addHeader:g,removeHeader:m,setBackground:_,showInsertPopup:e,showEditPopup:h,showColorsPopup:n,back:me,verticalAlign:M,horizontalAlign:I,applyStyle:T,selectedTable:we,selectedCells:ve,customColor:t}},_e.FE.DefineIcon("insertTable",{NAME:"table"}),_e.FE.RegisterCommand("insertTable",{title:"Insert Table",undo:!1,focus:!0,refreshOnCallback:!1,popup:!0,callback:function(){this.popups.isVisible("table.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("table.insert")):this.table.showInsertPopup()},plugin:"table"}),_e.FE.RegisterCommand("tableInsert",{callback:function(e,t,a){this.table.insert(t,a),this.popups.hide("table.insert")}}),_e.FE.DefineIcon("tableHeader",{NAME:"header",FA5NAME:"heading"}),_e.FE.RegisterCommand("tableHeader",{title:"Table Header",focus:!1,toggle:!0,callback:function(){this.popups.get("table.edit").find('.fr-command[data-cmd="tableHeader"]').hasClass("fr-active")?this.table.removeHeader():this.table.addHeader()},refresh:function(e){var t=this.table.selectedTable();0<t.length&&(0===t.find("th").length?e.removeClass("fr-active").attr("aria-pressed",!1):e.addClass("fr-active").attr("aria-pressed",!0))}}),_e.FE.DefineIcon("tableRows",{NAME:"bars"}),_e.FE.RegisterCommand("tableRows",{type:"dropdown",focus:!1,title:"Row",options:{above:"Insert row above",below:"Insert row below","delete":"Delete row"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=_e.FE.COMMANDS.tableRows.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableRows" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.language.translate(t[a])+"</a></li>");return e+"</ul>"},callback:function(e,t){"above"==t||"below"==t?this.table.insertRow(t):this.table.deleteRow()}}),_e.FE.DefineIcon("tableColumns",{NAME:"bars fa-rotate-90"}),_e.FE.RegisterCommand("tableColumns",{type:"dropdown",focus:!1,title:"Column",options:{before:"Insert column before",after:"Insert column after","delete":"Delete column"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=_e.FE.COMMANDS.tableColumns.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableColumns" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.language.translate(t[a])+"</a></li>");return e+"</ul>"},callback:function(e,t){"before"==t||"after"==t?this.table.insertColumn(t):this.table.deleteColumn()}}),_e.FE.DefineIcon("tableCells",{NAME:"square-o",FA5NAME:"square"}),_e.FE.RegisterCommand("tableCells",{type:"dropdown",focus:!1,title:"Cell",options:{merge:"Merge cells","vertical-split":"Vertical split","horizontal-split":"Horizontal split"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=_e.FE.COMMANDS.tableCells.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCells" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.language.translate(t[a])+"</a></li>");return e+"</ul>"},callback:function(e,t){"merge"==t?this.table.mergeCells():"vertical-split"==t?this.table.splitCellVertically():this.table.splitCellHorizontally()},refreshOnShow:function(e,t){1<this.$el.find(".fr-selected-cell").length?(t.find('a[data-param1="vertical-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="horizontal-split"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="merge"]').removeClass("fr-disabled").attr("aria-disabled",!1)):(t.find('a[data-param1="merge"]').addClass("fr-disabled").attr("aria-disabled",!0),t.find('a[data-param1="vertical-split"]').removeClass("fr-disabled").attr("aria-disabled",!1),t.find('a[data-param1="horizontal-split"]').removeClass("fr-disabled").attr("aria-disabled",!1))}}),_e.FE.DefineIcon("tableRemove",{NAME:"trash"}),_e.FE.RegisterCommand("tableRemove",{title:"Remove Table",focus:!1,callback:function(){this.table.remove()}}),_e.FE.DefineIcon("tableStyle",{NAME:"paint-brush"}),_e.FE.RegisterCommand("tableStyle",{title:"Table Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.tableStyles;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableStyle" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.language.translate(t[a])+"</a></li>");return e+"</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell").closest("table"),this.opts.tableMultipleStyles,this.opts.tableStyles)},refreshOnShow:function(e,t){var a=this.$el.find(".fr-selected-cell").closest("table");a&&t.find(".fr-command").each(function(){var e=_e(this).data("param1"),t=a.hasClass(e);_e(this).toggleClass("fr-active",t).attr("aria-selected",t)})}}),_e.FE.DefineIcon("tableCellBackground",{NAME:"tint"}),_e.FE.RegisterCommand("tableCellBackground",{title:"Cell Background",focus:!1,popup:!0,callback:function(){this.table.showColorsPopup()}}),_e.FE.RegisterCommand("tableCellBackgroundColor",{undo:!0,focus:!1,callback:function(e,t){this.table.setBackground(t)}}),_e.FE.DefineIcon("tableBack",{NAME:"arrow-left"}),_e.FE.RegisterCommand("tableBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.table.back()},refresh:function(e){0!==this.table.selectedCells().length||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),_e.FE.DefineIcon("tableCellVerticalAlign",{NAME:"arrows-v",FA5NAME:"arrows-alt-v"}),_e.FE.RegisterCommand("tableCellVerticalAlign",{type:"dropdown",focus:!1,title:"Vertical Align",options:{Top:"Align Top",Middle:"Align Middle",Bottom:"Align Bottom"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=_e.FE.COMMANDS.tableCellVerticalAlign.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellVerticalAlign" data-param1="'+a.toLowerCase()+'" title="'+this.language.translate(t[a])+'">'+this.language.translate(a)+"</a></li>");return e+"</ul>"},callback:function(e,t){this.table.verticalAlign(t)},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.$el.find(".fr-selected-cell").css("vertical-align")+'"]').addClass("fr-active").attr("aria-selected",!0)}}),_e.FE.DefineIcon("tableCellHorizontalAlign",{NAME:"align-left"}),_e.FE.DefineIcon("align-left",{NAME:"align-left"}),_e.FE.DefineIcon("align-right",{NAME:"align-right"}),_e.FE.DefineIcon("align-center",{NAME:"align-center"}),_e.FE.DefineIcon("align-justify",{NAME:"align-justify"}),_e.FE.RegisterCommand("tableCellHorizontalAlign",{type:"dropdown",focus:!1,title:"Horizontal Align",options:{left:"Align Left",center:"Align Center",right:"Align Right",justify:"Align Justify"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=_e.FE.COMMANDS.tableCellHorizontalAlign.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="tableCellHorizontalAlign" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.icon.create("align-"+a)+'<span class="fr-sr-only">'+this.language.translate(t[a])+"</span></a></li>");return e+"</ul>"},callback:function(e,t){this.table.horizontalAlign(t)},refresh:function(e){var t=this.table.selectedCells();t.length&&e.find("> *:first").replaceWith(this.icon.create("align-"+this.helpers.getAlignment(_e(t[0]))))},refreshOnShow:function(e,t){t.find('.fr-command[data-param1="'+this.helpers.getAlignment(this.$el.find(".fr-selected-cell:first"))+'"]').addClass("fr-active").attr("aria-selected",!0)}}),_e.FE.DefineIcon("tableCellStyle",{NAME:"magic"}),_e.FE.RegisterCommand("tableCellStyle",{title:"Cell Style",type:"dropdown",focus:!1,html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.tableCellStyles;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="tableCellStyle" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.language.translate(t[a])+"</a></li>");return e+"</ul>"},callback:function(e,t){this.table.applyStyle(t,this.$el.find(".fr-selected-cell"),this.opts.tableCellMultipleStyles,this.opts.tableCellStyles)},refreshOnShow:function(e,t){var a=this.$el.find(".fr-selected-cell:first");a&&t.find(".fr-command").each(function(){var e=_e(this).data("param1"),t=a.hasClass(e);_e(this).toggleClass("fr-active",t).attr("aria-selected",t)})}}),_e.FE.RegisterCommand("tableCellBackgroundCustomColor",{title:"OK",undo:!0,callback:function(){this.table.customColor()}}),_e.FE.DefineIcon("tableColorRemove",{NAME:"eraser"})});