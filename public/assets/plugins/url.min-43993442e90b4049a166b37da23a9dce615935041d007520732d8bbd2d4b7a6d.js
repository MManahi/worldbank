!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=function(e,n){return void 0===n&&(n="undefined"!=typeof window?require("jquery"):require("jquery")(e)),t(n)}:t(window.jQuery)}(function(p){p.FE.URLRegEx="(^| |\\u00A0)("+p.FE.LinkRegEx+"|([a-z0-9+-_.]{1,}@[a-z0-9+-_.]{1,}\\.[a-z0-9+-_]{1,}))$",p.FE.PLUGINS.url=function(i){function n(e,n,t){for(var r="";t.length&&"."==t[t.length-1];)r+=".",t=t.substring(0,t.length-1);var o=t;if(i.opts.linkConvertEmailAddress)i.helpers.isEmail(o)&&!/^mailto:.*/i.test(o)&&(o="mailto:"+o);else if(i.helpers.isEmail(o))return n+t;return/^((http|https|ftp|ftps|mailto|tel|sms|notes|data)\:)/i.test(o)||(o="//"+o),(n||"")+"<a"+(i.opts.linkAlwaysBlank?' target="_blank"':"")+(s?' rel="'+s+'"':"")+' data-fr-linked="true" href="'+o+'">'+t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&amp;/g,"&").replace(/&/g,"&amp;")+"</a>"+r}function r(){return new RegExp(p.FE.URLRegEx,"gi")}function o(e){return i.opts.linkAlwaysNoFollow&&(s="nofollow"),i.opts.linkAlwaysBlank&&(i.opts.linkNoOpener&&(s?s+=" noopener":s="noopener"),i.opts.linkNoReferrer&&(s?s+=" noreferrer":s="noreferrer")),e.replace(r(),n)}function l(e){return!!e&&("A"===e.tagName||!(!e.parentNode||e.parentNode==i.el)&&l(e.parentNode))}function a(e){var n=e.split(" ");return n[n.length-1]}function t(){var e=i.selection.ranges(0).startContainer;if(!e||e.nodeType!==Node.TEXT_NODE)return!1;if(l(e))return!1;if(r().test(a(e.textContent))){p(e).before(o(e.textContent));var n=p(e.parentNode).find("a[data-fr-linked]");n.removeAttr("data-fr-linked"),e.parentNode.removeChild(e),i.events.trigger("url.linked",[n.get(0)])}else if(e.textContent.split(" ").length<=2&&e.previousSibling&&"A"===e.previousSibling.tagName){var t=e.previousSibling.innerText+e.textContent;r().test(a(t))&&(p(e.previousSibling).replaceWith(o(t)),e.parentNode.removeChild(e))}}function e(){i.events.on("keypress",function(e){!i.selection.isCollapsed()||"."!=e.key&&")"!=e.key&&"("!=e.key||t()},!0),i.events.on("keydown",function(e){var n=e.which;!i.selection.isCollapsed()||n!=p.FE.KEYCODE.ENTER&&n!=p.FE.KEYCODE.SPACE||t()},!0),i.events.on("paste.beforeCleanup",function(e){if(i.helpers.isURL(e)){var n=null;return i.opts.linkAlwaysBlank&&(i.opts.linkNoOpener&&(n?n+=" noopener":n="noopener"),i.opts.linkNoReferrer&&(n?n+=" noreferrer":n="noreferrer")),"<a"+(i.opts.linkAlwaysBlank?' target="_blank"':"")+(n?' rel="'+n+'"':"")+' href="'+e+'" >'+e+"</a>"}})}var s=null;return{_init:e}}});