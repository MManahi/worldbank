!function(i){"function"==typeof define&&define.amd?define(["jquery"],i):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),i(t)}:i(window.jQuery)}(function(c){c.extend(c.FE.DEFAULTS,{quickInsertButtons:["image","video","embedly","table","ul","ol","hr"],quickInsertTags:["p","div","h1","h2","h3","h4","h5","h6","pre","blockquote"]}),c.FE.QUICK_INSERT_BUTTONS={},c.FE.DefineIcon("quickInsert",{PATH:'<path d="M22,16.75 L16.75,16.75 L16.75,22 L15.25,22.000 L15.25,16.75 L10,16.75 L10,15.25 L15.25,15.25 L15.25,10 L16.75,10 L16.75,15.25 L22,15.25 L22,16.75 Z"/>',template:"svg"}),c.FE.RegisterQuickInsertButton=function(e,t){c.FE.QUICK_INSERT_BUTTONS[e]=c.extend({undo:!0},t)},c.FE.RegisterQuickInsertButton("image",{icon:"insertImage",requiredPlugin:"image",title:"Insert Image",undo:!1,callback:function(){var e=this;e.shared.$qi_image_input||(e.shared.$qi_image_input=c('<input accept="image/*" name="quickInsertImage'+this.id+'" style="display: none;" type="file">'),c("body:first").append(e.shared.$qi_image_input),e.events.$on(e.shared.$qi_image_input,"change",function(){var e=c(this).data("inst");this.files&&(e.quickInsert.hide(),e.image.upload(this.files)),c(this).val("")},!0)),e.$qi_image_input=e.shared.$qi_image_input,e.helpers.isMobile()&&e.selection.save(),e.$qi_image_input.data("inst",e).trigger("click")}}),c.FE.RegisterQuickInsertButton("video",{icon:"insertVideo",requiredPlugin:"video",title:"Insert Video",undo:!1,callback:function(){var e=prompt(this.language.translate("Paste the URL of the video you want to insert."));e&&this.video.insertByURL(e)}}),c.FE.RegisterQuickInsertButton("embedly",{icon:"embedly",requiredPlugin:"embedly",title:"Embed URL",undo:!1,callback:function(){var e=prompt(this.language.translate("Paste the URL of any web content you want to insert."));e&&this.embedly.add(e)}}),c.FE.RegisterQuickInsertButton("table",{icon:"insertTable",requiredPlugin:"table",title:"Insert Table",callback:function(){this.table.insert(2,2)}}),c.FE.RegisterQuickInsertButton("ol",{icon:"formatOL",requiredPlugin:"lists",title:"Ordered List",callback:function(){this.lists.format("OL")}}),c.FE.RegisterQuickInsertButton("ul",{icon:"formatUL",requiredPlugin:"lists",title:"Unordered List",callback:function(){this.lists.format("UL")}}),c.FE.RegisterQuickInsertButton("hr",{icon:"insertHR",title:"Insert Horizontal Line",callback:function(){this.commands.insertHR()}}),c.FE.PLUGINS.quickInsert=function(r){function t(e){var t,i,n;t=e.offset().top-r.$box.offset().top,i=0-u.outerWidth(),r.opts.enter!=c.FE.ENTER_BR?n=(u.outerHeight()-e.outerHeight())/2:(c("<span>"+c.FE.INVISIBLE_SPACE+"</span>").insertAfter(e),n=(u.outerHeight()-e.next().outerHeight())/2,e.next().remove()),r.opts.iframe&&(t+=r.$iframe.offset().top-r.helpers.scrollTop()),u.hasClass("fr-on")&&0<=t&&d.css("top",t-n),0<=t&&t-n<=r.$box.outerHeight()-e.outerHeight()?(u.hasClass("fr-hidden")&&(u.hasClass("fr-on")&&o(),u.removeClass("fr-hidden")),u.css("top",t-n)):u.hasClass("fr-visible")&&(u.addClass("fr-hidden"),a()),u.css("left",i)}function n(e){u||i(),u.hasClass("fr-on")&&a(),r.$box.append(u),t(e),u.data("tag",e),u.addClass("fr-visible")}function e(){if(r.core.hasFocus()){var e=r.selection.element();if(r.opts.enter==c.FE.ENTER_BR||r.node.isBlock(e)||(e=r.node.blockParent(e)),r.opts.enter==c.FE.ENTER_BR&&!r.node.isBlock(e)){var t=r.node.deepestParent(e);t&&(e=t)}var i=function(){return r.opts.enter==c.FE.ENTER_BR&&("BR"==e.tagName&&(!e.previousSibling||"BR"==e.previousSibling.tagName||r.node.isBlock(e.previousSibling))||r.node.isEmpty(e)&&(!e.previousSibling||"BR"==e.previousSibling.tagName||r.node.isBlock(e.previousSibling))&&(!e.nextSibling||"BR"==e.nextSibling.tagName||r.node.isBlock(e.nextSibling)))};e&&(function(){return r.opts.enter!=c.FE.ENTER_BR&&r.node.isEmpty(e)&&r.node.isElement(e.parentNode)&&0<=r.opts.quickInsertTags.indexOf(e.tagName.toLowerCase())}()||i())?u&&u.data("tag").is(c(e))&&u.hasClass("fr-on")?a():r.selection.isCollapsed()&&n(c(e)):s()}}function s(){u&&(r.html.checkIfEmpty(),u.hasClass("fr-on")&&a(),u.removeClass("fr-visible fr-on"),u.css("left",-9999).css("top",-9999))}function o(e){if(e&&e.preventDefault(),u.hasClass("fr-on")&&!u.hasClass("fr-hidden"))a();else{if(!r.shared.$qi_helper){for(var t=r.opts.quickInsertButtons,i='<div class="fr-qi-helper">',n=0,s=0;s<t.length;s++){var o=c.FE.QUICK_INSERT_BUTTONS[t[s]];o&&(!o.requiredPlugin||c.FE.PLUGINS[o.requiredPlugin]&&0<=r.opts.pluginsEnabled.indexOf(o.requiredPlugin))&&(i+='<a class="fr-btn fr-floating-btn" role="button" title="'+r.language.translate(o.title)+'" tabIndex="-1" data-cmd="'+t[s]+'" style="transition-delay: '+.025*n+++'s;">'+r.icon.create(o.icon)+"</a>")}i+="</div>",r.shared.$qi_helper=c(i),r.tooltip.bind(r.shared.$qi_helper,"> a.fr-btn")}(d=r.shared.$qi_helper).appendTo(r.$box),setTimeout(function(){d.css("top",parseFloat(u.css("top"))),d.css("left",parseFloat(u.css("left"))+u.outerWidth()),d.find("a").addClass("fr-size-1"),u.addClass("fr-on")},10)}}function a(){var e=r.$box.find(".fr-qi-helper");e.length&&(e.find("a").removeClass("fr-size-1"),e.css("left",-9999),u.hasClass("fr-hidden")||u.removeClass("fr-on"))}function i(){r.shared.$quick_insert||(r.shared.$quick_insert=c('<div class="fr-quick-insert"><a class="fr-floating-btn" role="button" tabIndex="-1" title="'+r.language.translate("Quick Insert")+'">'+r.icon.create("quickInsert")+"</a></div>")),u=r.shared.$quick_insert,r.tooltip.bind(r.$box,".fr-quick-insert > a.fr-floating-btn"),r.events.on("destroy",function(){u.removeClass("fr-on").appendTo(c("body:first")).css("left",-9999).css("top",-9999),d&&(a(),d.appendTo(c("body:first")))},!0),r.events.on("shared.destroy",function(){u.html("").removeData().remove(),u=null,d&&(d.html("").removeData().remove(),d=null)},!0),r.events.on("commands.before",s),r.events.on("commands.after",function(){r.popups.areVisible()||e()}),r.events.bindClick(r.$box,".fr-quick-insert > a",o),r.events.bindClick(r.$box,".fr-qi-helper > a.fr-btn",function(e){var t=c(e.currentTarget).data("cmd");c.FE.QUICK_INSERT_BUTTONS[t].callback.apply(r,[e.currentTarget]),c.FE.QUICK_INSERT_BUTTONS[t].undo&&r.undo.saveStep(),r.quickInsert.hide()}),r.events.$on(r.$wp,"scroll",function(){u.hasClass("fr-visible")&&t(u.data("tag"))})}function l(){return!!r.$wp&&(r.opts.iframe&&r.$el.parent("html").find("head").append('<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">'),r.popups.onShow("image.edit",s),r.events.on("mouseup",e),r.helpers.isMobile()&&r.events.$on(c(r.o_doc),"selectionchange",e),r.events.on("blur",s),r.events.on("keyup",e),void r.events.on("keydown",function(){setTimeout(function(){e()},0)}))}var u,d;return{_init:l,hide:s}}});