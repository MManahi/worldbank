!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(e,t){return void 0===t&&(t="undefined"!=typeof window?require("jquery"):require("jquery")(e)),a(t)}:a(window.jQuery)}(function(Xe){Xe.extend(Xe.FE.POPUP_TEMPLATES,{"image.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_BY_URL_LAYER_][_PROGRESS_BAR_]","image.edit":"[_BUTTONS_]","image.alt":"[_BUTTONS_][_ALT_LAYER_]","image.size":"[_BUTTONS_][_SIZE_LAYER_]"}),Xe.extend(Xe.FE.DEFAULTS,{imageInsertButtons:["imageBack","|","imageUpload","imageByURL"],imageEditButtons:["imageReplace","imageAlign","imageCaption","imageRemove","|","imageLink","linkOpen","linkEdit","linkRemove","-","imageDisplay","imageStyle","imageAlt","imageSize"],imageAltButtons:["imageBack","|"],imageSizeButtons:["imageBack","|"],imageUpload:!0,imageUploadURL:"https://i.froala.com/upload",imageCORSProxy:"https://cors-anywhere.froala.com",imageUploadRemoteUrls:!0,imageUploadParam:"file",imageUploadParams:{},imageUploadToS3:!1,imageUploadMethod:"POST",imageMaxSize:10485760,imageAllowedTypes:["jpeg","jpg","png","gif"],imageResize:!0,imageResizeWithPercent:!1,imageRoundPercent:!1,imageDefaultWidth:300,imageDefaultAlign:"center",imageDefaultDisplay:"block",imageSplitHTML:!1,imageStyles:{"fr-rounded":"Rounded","fr-bordered":"Bordered","fr-shadow":"Shadow"},imageMove:!0,imageMultipleStyles:!0,imageTextNear:!0,imagePaste:!0,imagePasteProcess:!1,imageMinWidth:16,imageOutputSize:!1,imageDefaultMargin:5}),Xe.FE.PLUGINS.image=function(p){function f(){var e=p.popups.get("image.insert").find(".fr-image-by-url-layer input");e.val(""),$e&&e.val($e.attr("src")),e.trigger("change")}function a(){var e=p.$tb.find('.fr-command[data-cmd="insertImage"]'),t=p.popups.get("image.insert");if(t||(t=M()),y(),!t.hasClass("fr-active"))if(p.popups.refresh("image.insert"),p.popups.setContainer("image.insert",p.$tb),e.is(":visible")){var a=e.offset().left+e.outerWidth()/2,i=e.offset().top+(p.opts.toolbarBottom?10:e.outerHeight()-10);p.popups.show("image.insert",a,i,e.outerHeight())}else p.position.forSelection(t),p.popups.show("image.insert")}function r(){var e=p.popups.get("image.edit");if(e||(e=v()),e){var t=Se();xe()&&(t=t.find(".fr-img-wrap")),p.popups.setContainer("image.edit",p.$sc),p.popups.refresh("image.edit");var a=t.offset().left+t.outerWidth()/2,i=t.offset().top+t.outerHeight();p.popups.show("image.edit",a,i,t.outerHeight())}}function g(){y()}function i(e){0<e.parents(".fr-img-caption").length&&(e=e.parents(".fr-img-caption:first")),e.hasClass("fr-dii")||e.hasClass("fr-dib")||(e.addClass("fr-fi"+me(e)[0]),e.addClass("fr-di"+he(e)[0]),e.css("margin",""),e.css("float",""),e.css("display",""),e.css("z-index",""),e.css("position",""),e.css("overflow",""),e.css("vertical-align",""))}function n(e){0<e.parents(".fr-img-caption").length&&(e=e.parents(".fr-img-caption:first")),ue(e,e.hasClass("fr-dib")?"block":e.hasClass("fr-dii")?"inline":null,e.hasClass("fr-fil")?"left":e.hasClass("fr-fir")?"right":me(e)),e.removeClass("fr-dib fr-dii fr-fir fr-fil")}function o(){for(var e="IMG"==p.el.tagName?[p.el]:p.el.querySelectorAll("img"),t=0;t<e.length;t++){var a=Xe(e[t]);!p.opts.htmlUntouched&&p.opts.useClasses?((p.opts.imageDefaultAlign||p.opts.imageDefaultDisplay)&&i(a),p.opts.imageTextNear||(0<a.parents(".fr-img-caption").length?a.parents(".fr-img-caption:first").removeClass("fr-dii").addClass("fr-dib"):a.removeClass("fr-dii").addClass("fr-dib"))):p.opts.htmlUntouched||p.opts.useClasses||(p.opts.imageDefaultAlign||p.opts.imageDefaultDisplay)&&n(a),p.opts.iframe&&a.on("load",p.size.syncIframe)}}function d(e){void 0===e&&(e=!0);var t,a=Array.prototype.slice.call(p.el.querySelectorAll("img")),i=[];for(t=0;t<a.length;t++)if(i.push(a[t].getAttribute("src")),Xe(a[t]).toggleClass("fr-draggable",p.opts.imageMove),""===a[t].getAttribute("class")&&a[t].removeAttribute("class"),""===a[t].getAttribute("style")&&a[t].removeAttribute("style"),a[t].parentNode&&a[t].parentNode.parentNode&&p.node.hasClass(a[t].parentNode.parentNode,"fr-img-caption")){var r=a[t].parentNode.parentNode;p.browser.mozilla||r.setAttribute("contenteditable",!1),r.setAttribute("draggable",!1),r.classList.add("fr-draggable");var n=a[t].nextSibling;n&&n.setAttribute("contenteditable",!0)}if(Ke)for(t=0;t<Ke.length;t++)i.indexOf(Ke[t].getAttribute("src"))<0&&p.events.trigger("image.removed",[Xe(Ke[t])]);if(Ke&&e){var s=[];for(t=0;t<Ke.length;t++)s.push(Ke[t].getAttribute("src"));for(t=0;t<a.length;t++)s.indexOf(a[t].getAttribute("src"))<0&&p.events.trigger("image.loaded",[Xe(a[t])])}Ke=a}function l(){if(Ie||Q(),!$e)return!1;var e=p.$wp||p.$sc;e.append(Ie),Ie.data("instance",p);var t=e.scrollTop()-("static"!=e.css("position")?e.offset().top:0),a=e.scrollLeft()-("static"!=e.css("position")?e.offset().left:0);a-=p.helpers.getPX(e.css("border-left-width")),t-=p.helpers.getPX(e.css("border-top-width")),p.$el.is("img")&&p.$sc.is("body")&&(a=t=0);var i=Se();xe()&&(i=i.find(".fr-img-wrap")),Ie.css("top",(p.opts.iframe?i.offset().top:i.offset().top+t)-1).css("left",(p.opts.iframe?i.offset().left:i.offset().left+a)-1).css("width",i.get(0).getBoundingClientRect().width).css("height",i.get(0).getBoundingClientRect().height).addClass("fr-active")}function t(e){return'<div class="fr-handler fr-h'+e+'"></div>'}function u(e){xe()?$e.parents(".fr-img-caption").css("width",e):$e.css("width",e)}function s(e){if(!p.core.sameInstance(Ie))return!0;if(e.preventDefault(),e.stopPropagation(),p.$el.find("img.fr-error").left)return!1;p.undo.canDo()||p.undo.saveStep();var t=e.pageX||e.originalEvent.touches[0].pageX;if("mousedown"==e.type){var a=p.$oel.get(0).ownerDocument,i=a.defaultView||a.parentWindow,r=!1;try{r=i.location!=i.parent.location&&!(i.$&&i.$.FE)}catch(o){}r&&i.frameElement&&(t+=p.helpers.getPX(Xe(i.frameElement).offset().left)+i.frameElement.clientLeft)}(ke=Xe(this)).data("start-x",t),ke.data("start-width",$e.width()),ke.data("start-height",$e.height());var n=$e.width();if(p.opts.imageResizeWithPercent){var s=$e.parentsUntil(p.$el,p.html.blockTagsQuery()).get(0)||p.el;n=(n/Xe(s).outerWidth()*100).toFixed(2)+"%"}u(n),Fe.show(),p.popups.hideAll(),ge()}function c(e){if(!p.core.sameInstance(Ie))return!0;var t;if(ke&&$e){if(e.preventDefault(),p.$el.find("img.fr-error").left)return!1;var a=e.pageX||(e.originalEvent.touches?e.originalEvent.touches[0].pageX:null);if(!a)return!1;var i=a-ke.data("start-x"),r=ke.data("start-width");if((ke.hasClass("fr-hnw")||ke.hasClass("fr-hsw"))&&(i=0-i),p.opts.imageResizeWithPercent){var n=$e.parentsUntil(p.$el,p.html.blockTagsQuery()).get(0)||p.el;r=((r+i)/Xe(n).outerWidth()*100).toFixed(2),p.opts.imageRoundPercent&&(r=Math.round(r)),u(r+"%"),(t=xe()?(p.helpers.getPX($e.parents(".fr-img-caption").css("width"))/Xe(n).outerWidth()*100).toFixed(2):(p.helpers.getPX($e.css("width"))/Xe(n).outerWidth()*100).toFixed(2))===r||p.opts.imageRoundPercent||u(t+"%"),$e.css("height","").removeAttr("height")}else r+i>=p.opts.imageMinWidth&&(u(r+i),t=xe()?p.helpers.getPX($e.parents(".fr-img-caption").css("width")):p.helpers.getPX($e.css("width"))),t!==r+i&&u(t),(($e.attr("style")||"").match(/(^height:)|(; *height:)/)||$e.attr("height"))&&($e.css("height",ke.data("start-height")*$e.width()/ke.data("start-width")),$e.removeAttr("height"));l(),p.events.trigger("image.resize",[Re()])}}function m(e){if(!p.core.sameInstance(Ie))return!0;if(ke&&$e){if(e&&e.stopPropagation(),p.$el.find("img.fr-error").left)return!1;ke=null,Fe.hide(),l(),r(),p.undo.saveStep(),p.events.trigger("image.resizeEnd",[Re()])}}function h(e,t,a){p.edit.on(),$e&&$e.addClass("fr-error"),E(p.language.translate("Something went wrong. Please try again.")),!$e&&a&&J(a),p.events.trigger("image.error",[{code:e,message:We[e]},t,a])}function v(e){if(e)return p.$wp&&p.events.$on(p.$wp,"scroll",function(){$e&&p.popups.isVisible("image.edit")&&(p.events.disableBlur(),C($e))}),!0;var t="";if(0<p.opts.imageEditButtons.length){t+='<div class="fr-buttons">',t+=p.button.buildList(p.opts.imageEditButtons);var a={buttons:t+="</div>"};return p.popups.create("image.edit",a)}return!1}function b(e){var t=p.popups.get("image.insert");if(t||(t=M()),t.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),t.find(".fr-image-progress-bar-layer").addClass("fr-active"),t.find(".fr-buttons").hide(),$e){var a=Se();p.popups.setContainer("image.insert",p.$sc);var i=a.offset().left+a.width()/2,r=a.offset().top+a.height();p.popups.show("image.insert",i,r,a.outerHeight())}void 0===e&&w(p.language.translate("Uploading"),0)}function y(e){var t=p.popups.get("image.insert");if(t&&(t.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),t.find(".fr-image-progress-bar-layer").removeClass("fr-active"),t.find(".fr-buttons").show(),e||p.$el.find("img.fr-error").length)){if(p.events.focus(),p.$el.find("img.fr-error").length&&(p.$el.find("img.fr-error").remove(),p.undo.saveStep(),p.undo.run(),p.undo.dropRedo()),!p.$wp&&$e){var a=$e;fe(!0),p.selection.setAfter(a.get(0)),p.selection.restore()}p.popups.hide("image.insert")}}function w(e,t){var a=p.popups.get("image.insert");if(a){var i=a.find(".fr-image-progress-bar-layer");i.find("h3").text(e+(t?" "+t+"%":"")),i.removeClass("fr-error"),t?(i.find("div").removeClass("fr-indeterminate"),i.find("div > span").css("width",t+"%")):i.find("div").addClass("fr-indeterminate")}}function E(e){b();var t=p.popups.get("image.insert").find(".fr-image-progress-bar-layer");t.addClass("fr-error");var a=t.find("h3");a.text(e),p.events.disableBlur(),a.focus()}function e(){var e=p.popups.get("image.insert").find(".fr-image-by-url-layer input");if(0<e.val().length){b(),w(p.language.translate("Loading image"));var t=e.val();if(p.opts.imageUploadRemoteUrls&&p.opts.imageCORSProxy&&p.opts.imageUpload){var a=new XMLHttpRequest;a.responseType="blob",a.onload=function(){200==this.status?B([new Blob([this.response],{type:this.response.type||"image/png"})],$e):h(Pe)},a.onerror=function(){R(t,!0,[],$e)},a.open("GET",p.opts.imageCORSProxy+"/"+t,!0),a.send()}else R(t,!0,[],$e);e.val(""),e.blur()}}function C(e){le.call(e.get(0))}function A(){var e=Xe(this);p.popups.hide("image.insert"),e.removeClass("fr-uploading"),e.next().is("br")&&e.next().remove(),C(e),p.events.trigger("image.loaded",[e])}function R(s,e,o,l,f){p.edit.off(),w(p.language.translate("Loading image")),e&&(s=p.helpers.sanitizeURL(s));var t=new Image;t.onload=function(){var e,t;if(l){p.undo.canDo()||l.hasClass("fr-uploading")||p.undo.saveStep();var a=l.data("fr-old-src");l.data("fr-image-pasted")&&(a=null),p.$wp?((e=l.clone().removeData("fr-old-src").removeClass("fr-uploading").removeAttr("data-fr-image-pasted")).off("load"),a&&l.attr("src",a),l.replaceWith(e)):e=l;for(var i=e.get(0).attributes,r=0;r<i.length;r++){var n=i[r];0===n.nodeName.indexOf("data-")&&e.removeAttr(n.nodeName)}if(void 0!==o)for(t in o)o.hasOwnProperty(t)&&"link"!=t&&e.attr("data-"+t,o[t]);e.on("load",A),e.attr("src",s),p.edit.on(),d(!1),p.undo.saveStep(),p.events.disableBlur(),p.$el.blur(),p.events.trigger(a?"image.replaced":"image.inserted",[e,f])}else e=I(s,o,A),d(!1),p.undo.saveStep(),p.$el.blur(),p.events.trigger("image.inserted",[e,f])},t.onerror=function(){h(Pe)},b(p.language.translate("Loading image")),t.src=s}function S(e){try{if(!1===p.events.trigger("image.uploaded",[e],!0))return p.edit.on(),!1;var t=JSON.parse(e);return t.link?t:(h(Oe,e),!1)}catch(a){return h(Te,e),!1}}function D(e){try{var t=Xe(e).find("Location").text(),a=Xe(e).find("Key").text();return!1===p.events.trigger("image.uploadedToS3",[t,a,e],!0)?(p.edit.on(),!1):t}catch(g){return h(Te,e),!1}}function x(e){w(p.language.translate("Loading image"));var t=this.status,a=this.response,i=this.responseXML,r=this.responseText;try{if(p.opts.imageUploadToS3)if(201==t){var n=D(i);n&&R(n,!1,[],e,a||i)}else h(Te,a||i,e);else if(200<=t&&t<300){var s=S(r);s&&R(s.link,!1,s,e,a||r)}else h(Ne,a||r,e)}catch(o){h(Te,a||r,e)}}function U(){h(Te,this.response||this.responseText||this.responseXML)}function $(e){if(e.lengthComputable){var t=e.loaded/e.total*100|0;w(p.language.translate("Uploading"),t)}}function I(e,t,a){var i,r="";if(t&&void 0!==t)for(i in t)t.hasOwnProperty(i)&&"link"!=i&&(r+=" data-"+i+'="'+t[i]+'"');var n=p.opts.imageDefaultWidth;n&&"auto"!=n&&(n+=p.opts.imageResizeWithPercent?"%":"px");var s=Xe('<img src="'+e+'"'+r+(n?' style="width: '+n+';"':"")+">");ue(s,p.opts.imageDefaultDisplay,p.opts.imageDefaultAlign),s.on("load",a),s.on("error",function(){Xe(this).addClass("fr-error"),h(_e)}),p.edit.on(),p.events.focus(!0),p.selection.restore(),p.undo.saveStep(),p.opts.imageSplitHTML?p.markers.split():p.markers.insert(),p.html.wrap();var o=p.$el.find(".fr-marker");return o.length?(o.parent().is("hr")&&o.parent().after(o),p.node.isLastSibling(o)&&o.parent().hasClass("fr-deletable")&&o.insertAfter(o.parent()),o.replaceWith(s)):p.$el.append(s),p.selection.clear(),s}function k(){p.edit.on(),y(!0)}function F(t,a,e,r){function n(){var e=Xe(this);e.off("load"),e.addClass("fr-uploading"),e.next().is("br")&&e.next().remove(),p.placeholder.refresh(),C(e),l(),b(),p.edit.off(),t.onload=function(){x.call(t,e)},t.onerror=U,t.upload.onprogress=$,t.onabort=k,e.off("abortUpload").on("abortUpload",function(){4!=t.readyState&&t.abort()}),t.send(a)}var s=new FileReader;s.addEventListener("load",function(){var e=s.result;if(s.result.indexOf("svg+xml")<0){for(var t=atob(s.result.split(",")[1]),a=[],i=0;i<t.length;i++)a.push(t.charCodeAt(i));e=window.URL.createObjectURL(new Blob([new Uint8Array(a)],{type:"image/jpeg"}))}r?(r.on("load",n),r.one("error",function(){r.off("load"),r.attr("src",r.data("fr-old-src")),h(_e)}),p.edit.on(),p.undo.saveStep(),r.data("fr-old-src",r.attr("src")),r.attr("src",e)):I(e,null,n)},!1),s.readAsDataURL(e)}function B(e,t){if(void 0!==e&&0<e.length){if(!1===p.events.trigger("image.beforeUpload",[e,t]))return!1;var a,i=e[0];if(i.name||(i.name=(new Date).getTime()+".jpg"),i.size>p.opts.imageMaxSize)return h(Me),!1;if(p.opts.imageAllowedTypes.indexOf(i.type.replace(/image\//g,""))<0)return h(Le),!1;if(p.drag_support.formdata&&(a=p.drag_support.formdata?new FormData:null),a){var r;if(!1!==p.opts.imageUploadToS3)for(r in a.append("key",p.opts.imageUploadToS3.keyStart+(new Date).getTime()+"-"+(i.name||"untitled")),a.append("success_action_status","201"),a.append("X-Requested-With","xhr"),a.append("Content-Type",i.type),p.opts.imageUploadToS3.params)p.opts.imageUploadToS3.params.hasOwnProperty(r)&&a.append(r,p.opts.imageUploadToS3.params[r]);for(r in p.opts.imageUploadParams)p.opts.imageUploadParams.hasOwnProperty(r)&&a.append(r,p.opts.imageUploadParams[r]);a.append(p.opts.imageUploadParam,i,i.name);var n=p.opts.imageUploadURL;p.opts.imageUploadToS3&&(n=p.opts.imageUploadToS3.uploadURL?p.opts.imageUploadToS3.uploadURL:"https://"+p.opts.imageUploadToS3.region+".amazonaws.com/"+p.opts.imageUploadToS3.bucket),F(p.core.getXHR(n,p.opts.imageUploadMethod),a,i,t||$e)}}}function P(i){p.events.$on(i,"dragover dragenter",".fr-image-upload-layer",function(){return Xe(this).addClass("fr-drop"),!1},!0),p.events.$on(i,"dragleave dragend",".fr-image-upload-layer",function(){return Xe(this).removeClass("fr-drop"),!1},!0),p.events.$on(i,"drop",".fr-image-upload-layer",function(e){e.preventDefault(),e.stopPropagation(),Xe(this).removeClass("fr-drop");var t=e.originalEvent.dataTransfer;if(t&&t.files){var a=i.data("instance")||p;a.events.disableBlur(),a.image.upload(t.files),a.events.enableBlur()}},!0),p.helpers.isIOS()&&p.events.$on(i,"touchstart",'.fr-image-upload-layer input[type="file"]',function(){Xe(this).trigger("click")},!0),p.events.$on(i,"change",'.fr-image-upload-layer input[type="file"]',function(){if(this.files){var e=i.data("instance")||p;e.events.disableBlur(),i.find("input:focus").blur(),e.events.enableBlur(),e.image.upload(this.files,$e)}Xe(this).val("")},!0)}function O(e){return e.is("img")&&0<e.parents(".fr-img-caption").length?e.parents(".fr-img-caption"):void 0}function N(e){var t=e.originalEvent.dataTransfer;if(t&&t.files&&t.files.length){var a=t.files[0];if(a&&a.type&&-1!==a.type.indexOf("image")&&0<=p.opts.imageAllowedTypes.indexOf(a.type.replace(/image\//g,""))){if(!p.opts.imageUpload)return e.preventDefault(),e.stopPropagation(),!1;p.markers.remove(),p.markers.insertAtPoint(e.originalEvent),p.$el.find(".fr-marker").replaceWith(Xe.FE.MARKERS),0===p.$el.find(".fr-marker").length&&p.selection.setAtEnd(p.el),p.popups.hideAll();var i=p.popups.get("image.insert");i||(i=M()),p.popups.setContainer("image.insert",p.$sc);var r=e.originalEvent.pageX,n=e.originalEvent.pageY;return p.opts.iframe&&(n+=p.$iframe.offset().top,r+=p.$iframe.offset().left),p.popups.show("image.insert",r,n),b(),0<=p.opts.imageAllowedTypes.indexOf(a.type.replace(/image\//g,""))?(fe(!0),B(t.files)):h(Le),e.preventDefault(),e.stopPropagation(),!1}}}function T(){p.events.$on(p.$el,p._mousedown,"IMG"==p.el.tagName?null:'img:not([contenteditable="false"])',function(e){return"false"==Xe(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")||(p.helpers.isMobile()||p.selection.clear(),Be=!0,p.popups.areVisible()&&p.events.disableBlur(),p.browser.msie&&(p.events.disableBlur(),p.$el.attr("contenteditable",!1)),p.draggable||"touchstart"==e.type||e.preventDefault(),void e.stopPropagation())}),p.events.$on(p.$el,p._mouseup,"IMG"==p.el.tagName?null:'img:not([contenteditable="false"])',function(e){return"false"==Xe(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable")||void(Be&&(Be=!1,e.stopPropagation(),p.browser.msie&&(p.$el.attr("contenteditable",!0),p.events.enableBlur())))}),p.events.on("keyup",function(e){if(e.shiftKey&&""===p.selection.text().replace(/\n/g,"")&&p.keys.isArrow(e.which)){var t=p.selection.element(),a=p.selection.endElement();t&&"IMG"==t.tagName?C(Xe(t)):a&&"IMG"==a.tagName&&C(Xe(a))}},!0),p.events.on("drop",N),p.events.on("element.beforeDrop",O),p.events.on("mousedown window.mousedown",pe),p.events.on("window.touchmove",ge),p.events.on("mouseup window.mouseup",function(){return $e?(fe(),!1):void ge()}),p.events.on("commands.mousedown",function(e){0<e.parents(".fr-toolbar").length&&fe()}),p.events.on("blur image.hideResizer commands.undo commands.redo element.dropped",function(){Be=!1,fe(!0)}),p.events.on("modals.hide",function(){$e&&(Ce(),p.selection.clear())})}function M(e){if(e)return p.popups.onRefresh("image.insert",f),p.popups.onHide("image.insert",g),!0;var t,a="";p.opts.imageUpload||p.opts.imageInsertButtons.splice(p.opts.imageInsertButtons.indexOf("imageUpload"),1),1<p.opts.imageInsertButtons.length&&(a='<div class="fr-buttons">'+p.button.buildList(p.opts.imageInsertButtons)+"</div>");var i=p.opts.imageInsertButtons.indexOf("imageUpload"),r=p.opts.imageInsertButtons.indexOf("imageByURL"),n="";0<=i&&(t=" fr-active",0<=r&&r<i&&(t=""),n='<div class="fr-image-upload-layer'+t+' fr-layer" id="fr-image-upload-layer-'+p.id+'"><strong>'+p.language.translate("Drop image")+"</strong><br>("+p.language.translate("or click")+')<div class="fr-form"><input type="file" accept="image/'+p.opts.imageAllowedTypes.join(", image/").toLowerCase()+'" tabIndex="-1" aria-labelledby="fr-image-upload-layer-'+p.id+'" role="button"></div></div>');var s="";0<=r&&(t=" fr-active",0<=i&&i<r&&(t=""),s='<div class="fr-image-by-url-layer'+t+' fr-layer" id="fr-image-by-url-layer-'+p.id+'"><div class="fr-input-line"><input id="fr-image-by-url-layer-text-'+p.id+'" type="text" placeholder="http://" tabIndex="1" aria-required="true"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageInsertByURL" tabIndex="2" role="button">'+p.language.translate("Insert")+"</button></div></div>");var o={buttons:a,upload_layer:n,by_url_layer:s,progress_bar:'<div class="fr-image-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="imageDismissError" tabIndex="2" role="button">OK</button></div></div>'},l=p.popups.create("image.insert",o);return p.$wp&&p.events.$on(p.$wp,"scroll",function(){$e&&p.popups.isVisible("image.insert")&&Ee()}),P(l),l}function L(){$e&&p.popups.get("image.alt").find("input").val($e.attr("alt")||"").trigger("change")}function z(){var e=p.popups.get("image.alt");e||(e=_()),y(),p.popups.refresh("image.alt"),p.popups.setContainer("image.alt",p.$sc);var t=Se();xe()&&(t=t.find(".fr-img-wrap"));var a=t.offset().left+t.outerWidth()/2,i=t.offset().top+t.outerHeight();p.popups.show("image.alt",a,i,t.outerHeight())}function _(e){if(e)return p.popups.onRefresh("image.alt",L),!0;var t={buttons:'<div class="fr-buttons">'+p.button.buildList(p.opts.imageAltButtons)+"</div>",alt_layer:'<div class="fr-image-alt-layer fr-layer fr-active" id="fr-image-alt-layer-'+p.id+'"><div class="fr-input-line"><input id="fr-image-alt-layer-text-'+p.id+'" type="text" placeholder="'+p.language.translate("Alternate Text")+'" tabIndex="1"></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetAlt" tabIndex="2" role="button">'+p.language.translate("Update")+"</button></div></div>"},a=p.popups.create("image.alt",t);return p.$wp&&p.events.$on(p.$wp,"scroll.image-alt",function(){$e&&p.popups.isVisible("image.alt")&&z()}),a}function W(e){if($e){var t=p.popups.get("image.alt");$e.attr("alt",e||t.find("input").val()||""),t.find("input:focus").blur(),C($e)}}function K(){if($e){var e=p.popups.get("image.size");e.find('input[name="width"]').val($e.get(0).style.width).trigger("change"),e.find('input[name="height"]').val($e.get(0).style.height).trigger("change")}}function H(){var e=p.popups.get("image.size");e||(e=Y()),y(),p.popups.refresh("image.size"),p.popups.setContainer("image.size",p.$sc);var t=Se();xe()&&(t=t.find(".fr-img-wrap"));var a=t.offset().left+t.outerWidth()/2,i=t.offset().top+t.outerHeight();p.popups.show("image.size",a,i,t.outerHeight())}function Y(e){if(e)return p.popups.onRefresh("image.size",K),!0;var t={buttons:'<div class="fr-buttons">'+p.button.buildList(p.opts.imageSizeButtons)+"</div>",size_layer:'<div class="fr-image-size-layer fr-layer fr-active" id="fr-image-size-layer-'+p.id+'"><div class="fr-image-group"><div class="fr-input-line"><input id="fr-image-size-layer-width-'+p.id+'" type="text" name="width" placeholder="'+p.language.translate("Width")+'" tabIndex="1"></div><div class="fr-input-line"><input id="fr-image-size-layer-height'+p.id+'" type="text" name="height" placeholder="'+p.language.translate("Height")+'" tabIndex="1"></div></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-submit" data-cmd="imageSetSize" tabIndex="2" role="button">'+p.language.translate("Update")+"</button></div></div>"},a=p.popups.create("image.size",t);return p.$wp&&p.events.$on(p.$wp,"scroll.image-size",function(){$e&&p.popups.isVisible("image.size")&&H()}),a}function X(e,t){if($e){var a=p.popups.get("image.size");e=e||a.find('input[name="width"]').val()||"",t=t||a.find('input[name="height"]').val()||"";var i=/^[\d]+((px)|%)*$/g;$e.removeAttr("width").removeAttr("height"),e.match(i)?$e.css("width",e):$e.css("width",""),t.match(i)?$e.css("height",t):$e.css("height",""),xe()&&($e.parent().removeAttr("width").removeAttr("height"),e.match(i)?$e.parent().css("width",e):$e.parent().css("width",""),t.match(i)?$e.parent().css("height",t):$e.parent().css("height","")),a.find("input:focus").blur(),C($e)}}function j(e){var t,a,i=p.popups.get("image.insert");if($e||p.opts.toolbarInline){if($e){var r=Se();xe()&&(r=r.find(".fr-img-wrap")),a=r.offset().top+r.outerHeight(),t=r.offset().left+r.outerWidth()/2}}else{var n=p.$tb.find('.fr-command[data-cmd="insertImage"]');t=n.offset().left+n.outerWidth()/2,a=n.offset().top+(p.opts.toolbarBottom?10:n.outerHeight()-10)}!$e&&p.opts.toolbarInline&&(a=i.offset().top-p.helpers.getPX(i.css("margin-top")),i.hasClass("fr-above")&&(a+=i.outerHeight())),i.find(".fr-layer").removeClass("fr-active"),i.find(".fr-"+e+"-layer").addClass("fr-active"),p.popups.show("image.insert",t,a,$e?$e.outerHeight():0),p.accessibility.focusPopup(i)}function G(e){p.popups.get("image.insert").find(".fr-image-upload-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)}function q(e){p.popups.get("image.insert").find(".fr-image-by-url-layer").hasClass("fr-active")&&e.addClass("fr-active").attr("aria-pressed",!0)}function V(e,t,a,i){return e.pageX=t,s.call(this,e),e.pageX=e.pageX+a*Math.floor(Math.pow(1.1,i)),c.call(this,e),m.call(this,e),++i}function Q(){var e;if(p.shared.$image_resizer?(Ie=p.shared.$image_resizer,Fe=p.shared.$img_overlay,p.events.on("destroy",function(){Ie.removeClass("fr-active").appendTo(Xe("body:first"))},!0)):(p.shared.$image_resizer=Xe('<div class="fr-image-resizer"></div>'),Ie=p.shared.$image_resizer,p.events.$on(Ie,"mousedown",function(e){e.stopPropagation()},!0),p.opts.imageResize&&(Ie.append(t("nw")+t("ne")+t("sw")+t("se")),p.shared.$img_overlay=Xe('<div class="fr-image-overlay"></div>'),Fe=p.shared.$img_overlay,e=Ie.get(0).ownerDocument,Xe(e).find("body:first").append(Fe))),p.events.on("shared.destroy",function(){Ie.html("").removeData().remove(),Ie=null,p.opts.imageResize&&(Fe.remove(),Fe=null)},!0),p.helpers.isMobile()||p.events.$on(Xe(p.o_win),"resize",function(){$e&&!$e.hasClass("fr-uploading")?fe(!0):$e&&(l(),Ee(),b(!1))}),p.opts.imageResize){e=Ie.get(0).ownerDocument,p.events.$on(Ie,p._mousedown,".fr-handler",s),p.events.$on(Xe(e),p._mousemove,c),p.events.$on(Xe(e.defaultView||e.parentWindow),p._mouseup,m),p.events.$on(Fe,"mouseleave",m);var i=1,r=null,n=0;p.events.on("keydown",function(e){if($e){var t=-1!=navigator.userAgent.indexOf("Mac OS X")?e.metaKey:e.ctrlKey,a=e.which;(a!==r||200<e.timeStamp-n)&&(i=1),(a==Xe.FE.KEYCODE.EQUALS||p.browser.mozilla&&a==Xe.FE.KEYCODE.FF_EQUALS)&&t&&!e.altKey?i=V.call(this,e,1,1,i):(a==Xe.FE.KEYCODE.HYPHEN||p.browser.mozilla&&a==Xe.FE.KEYCODE.FF_HYPHEN)&&t&&!e.altKey?i=V.call(this,e,2,-1,i):p.keys.ctrlKey(e)||a!=Xe.FE.KEYCODE.ENTER||($e.before("<br>"),C($e)),r=a,n=e.timeStamp}},!0),p.events.on("keyup",function(){i=1})}}function J(e){(e=e||Se())&&!1!==p.events.trigger("image.beforeRemove",[e])&&(p.popups.hideAll(),Ce(),fe(!0),p.undo.canDo()||p.undo.saveStep(),e.get(0)==p.el?e.removeAttr("src"):("A"==e.get(0).parentNode.tagName?(p.selection.setBefore(e.get(0).parentNode)||p.selection.setAfter(e.get(0).parentNode)||e.parent().after(Xe.FE.MARKERS),Xe(e.get(0).parentNode).remove()):(p.selection.setBefore(e.get(0))||p.selection.setAfter(e.get(0))||e.after(Xe.FE.MARKERS),e.remove()),p.html.fillEmptyBlocks(),p.selection.restore()),p.undo.saveStep())}function Z(e){var t=e.which;if($e&&(t==Xe.FE.KEYCODE.BACKSPACE||t==Xe.FE.KEYCODE.DELETE))return e.preventDefault(),e.stopPropagation(),J(),!1;if($e&&t==Xe.FE.KEYCODE.ESC){var a=$e;return fe(!0),p.selection.setAfter(a.get(0)),p.selection.restore(),e.preventDefault(),!1}if($e&&(t==Xe.FE.KEYCODE.ARROW_LEFT||t==Xe.FE.KEYCODE.ARROW_RIGHT)){var i=$e.get(0);return fe(!0),t==Xe.FE.KEYCODE.ARROW_LEFT?p.selection.setBefore(i):p.selection.setAfter(i),p.selection.restore(),e.preventDefault(),!1}return $e&&t!=Xe.FE.KEYCODE.F10&&!p.keys.isBrowserAction(e)?(e.preventDefault(),e.stopPropagation(),!1):void 0}function ee(e){if(e&&"IMG"==e.tagName){if(p.node.hasClass(e,"fr-uploading")||p.node.hasClass(e,"fr-error")?e.parentNode.removeChild(e):p.node.hasClass(e,"fr-draggable")&&e.classList.remove("fr-draggable"),e.parentNode&&e.parentNode.parentNode&&p.node.hasClass(e.parentNode.parentNode,"fr-img-caption")){var t=e.parentNode.parentNode;t.removeAttribute("contenteditable"),t.removeAttribute("draggable"),t.classList.remove("fr-draggable");var a=e.nextSibling;a&&a.removeAttribute("contenteditable")}}else if(e&&e.nodeType==Node.ELEMENT_NODE)for(var i=e.querySelectorAll("img.fr-uploading, img.fr-error, img.fr-draggable"),r=0;r<i.length;r++)ee(i[r])}function te(){var i;(T(),"IMG"==p.el.tagName&&p.$el.addClass("fr-view"),p.events.$on(p.$el,p.helpers.isMobile()&&!p.helpers.isWindowsPhone()?"touchend":"click","IMG"==p.el.tagName?null:'img:not([contenteditable="false"])',le),p.helpers.isMobile()&&(p.events.$on(p.$el,"touchstart","IMG"==p.el.tagName?null:'img:not([contenteditable="false"])',function(){He=!1}),p.events.$on(p.$el,"touchmove",function(){He=!0})),p.$wp?(p.events.on("window.keydown keydown",Z,!0),p.events.on("keyup",function(e){return(!$e||e.which!=Xe.FE.KEYCODE.ENTER)&&void 0},!0)):p.events.$on(p.$win,"keydown",Z),p.events.on("toolbar.esc",function(){if($e){if(p.$wp)p.events.disableBlur(),p.events.focus();else{var e=$e;fe(!0),p.selection.setAfter(e.get(0)),p.selection.restore()}return!1}},!0),p.events.on("toolbar.focusEditor",function(){return!$e&&void 0},!0),p.events.on("window.cut window.copy",function(e){if($e&&p.popups.isVisible("image.edit")&&!p.popups.get("image.edit").find(":focus").length){var t=Se();xe()?(t.before(Xe.FE.START_MARKER),t.after(Xe.FE.END_MARKER),p.selection.restore(),p.paste.saveCopiedText(t.get(0).outerHTML,t.text())):(Ce(),p.paste.saveCopiedText($e.get(0).outerHTML,$e.attr("alt"))),"copy"==e.type?setTimeout(function(){C($e)}):(fe(!0),p.undo.saveStep(),setTimeout(function(){p.undo.saveStep()},0))}},!0),p.browser.msie&&p.events.on("keydown",function(e){if(!p.selection.isCollapsed()||!$e)return!0;var t=e.which;t==Xe.FE.KEYCODE.C&&p.keys.ctrlKey(e)?p.events.trigger("window.copy"):t==Xe.FE.KEYCODE.X&&p.keys.ctrlKey(e)&&p.events.trigger("window.cut")}),p.events.$on(Xe(p.o_win),"keydown",function(e){var t=e.which;return $e&&t==Xe.FE.KEYCODE.BACKSPACE?(e.preventDefault(),!1):void 0}),p.events.$on(p.$win,"keydown",function(e){var t=e.which;$e&&$e.hasClass("fr-uploading")&&t==Xe.FE.KEYCODE.ESC&&$e.trigger("abortUpload")}),p.events.on("destroy",function(){$e&&$e.hasClass("fr-uploading")&&$e.trigger("abortUpload")}),p.events.on("paste.before",se),p.events.on("paste.beforeCleanup",oe),p.events.on("paste.after",ie),p.events.on("html.set",o),p.events.on("html.inserted",o),o(),p.events.on("destroy",function(){Ke=[]}),p.events.on("html.processGet",ee),p.opts.imageOutputSize)&&p.events.on("html.beforeGet",function(){i=p.el.querySelectorAll("img");for(var e=0;e<i.length;e++){var t=i[e].style.width||Xe(i[e]).width(),a=i[e].style.height||Xe(i[e]).height();t&&i[e].setAttribute("width",(""+t).replace(/px/,"")),a&&i[e].setAttribute("height",(""+a).replace(/px/,""))}});p.opts.iframe&&p.events.on("image.loaded",p.size.syncIframe),p.$wp&&(d(),p.events.on("contentChanged",d)),p.events.$on(Xe(p.o_win),"orientationchange.image",function(){setTimeout(function(){$e&&C($e)},100)}),v(!0),M(!0),Y(!0),_(!0),p.events.on("node.remove",function(e){return"IMG"==e.get(0).tagName?(J(e),!1):void 0})}function ae(e){if(!1===p.events.trigger("image.beforePasteUpload",[e]))return!1;$e=Xe(e),l(),r(),Ee(),b();for(var t=atob(Xe(e).attr("src").split(",")[1]),a=[],i=0;i<t.length;i++)a.push(t.charCodeAt(i));B([new Blob([new Uint8Array(a)],{type:"image/jpeg"})],$e)}function ie(){p.opts.imagePaste?p.$el.find("img[data-fr-image-pasted]").each(function(e,a){if(p.opts.imagePasteProcess){var t=p.opts.imageDefaultWidth;t&&"auto"!=t&&(t+=p.opts.imageResizeWithPercent?"%":"px"),Xe(a).css("width",t).removeClass("fr-dii fr-dib fr-fir fr-fil"),ue(Xe(a),p.opts.imageDefaultDisplay,p.opts.imageDefaultAlign)}if(0===a.src.indexOf("data:"))ae(a);else if(0===a.src.indexOf("blob:")||0===a.src.indexOf("http")&&p.opts.imageUploadRemoteUrls&&p.opts.imageCORSProxy){var i=new Image;i.crossOrigin="Anonymous",i.onload=function(){var e=p.o_doc.createElement("CANVAS"),t=e.getContext("2d");e.height=this.naturalHeight,e.width=this.naturalWidth,t.drawImage(this,0,0),a.src=e.toDataURL("image/png"),ae(a)},i.src=(0===a.src.indexOf("blob:")?"":p.opts.imageCORSProxy+"/")+a.src}else 0!==a.src.indexOf("http")||0===a.src.indexOf("https://mail.google.com/mail")?(p.selection.save(),Xe(a).remove(),p.selection.restore()):Xe(a).removeAttr("data-fr-image-pasted")}):p.$el.find("img[data-fr-image-pasted]").remove()}function re(e){var t=e.target.result,a=p.opts.imageDefaultWidth;a&&"auto"!=a&&(a+=p.opts.imageResizeWithPercent?"%":"px"),p.undo.saveStep(),p.html.insert('<img data-fr-image-pasted="true" src="'+t+'"'+(a?' style="width: '+a+';"':"")+">");var i=p.$el.find('img[data-fr-image-pasted="true"]');i&&ue(i,p.opts.imageDefaultDisplay,p.opts.imageDefaultAlign),p.events.trigger("paste.after")}function ne(e){var t=new FileReader;t.onload=re,t.readAsDataURL(e)}function se(e){if(e&&e.clipboardData&&e.clipboardData.items){var t=null;if(e.clipboardData.getData("text/rtf"))t=e.clipboardData.items[0].getAsFile();else for(var a=0;a<e.clipboardData.items.length&&!(t=e.clipboardData.items[a].getAsFile());a++);
if(t)return ne(t),!1}}function oe(e){return e.replace(/<img /gi,'<img data-fr-image-pasted="true" ')}function le(e){if("false"==Xe(this).parents("[contenteditable]:not(.fr-element):not(.fr-img-caption):not(body):first").attr("contenteditable"))return!0;if(e&&"touchend"==e.type&&He)return!0;if(e&&p.edit.isDisabled())return e.stopPropagation(),e.preventDefault(),!1;for(var t=0;t<Xe.FE.INSTANCES.length;t++)Xe.FE.INSTANCES[t]!=p&&Xe.FE.INSTANCES[t].events.trigger("image.hideResizer");p.toolbar.disable(),e&&(e.stopPropagation(),e.preventDefault()),p.helpers.isMobile()&&(p.events.disableBlur(),p.$el.blur(),p.events.enableBlur()),p.opts.iframe&&p.size.syncIframe(),$e=Xe(this),p.browser.msie||Ce(),l(),r(),p.browser.msie||p.selection.clear(),p.helpers.isIOS()&&(p.events.disableBlur(),p.$el.blur()),p.button.bulkRefresh(),p.events.trigger("video.hideResizer")}function fe(e){$e&&(de()||!0===e)&&(p.toolbar.enable(),Ie.removeClass("fr-active"),p.popups.hide("image.edit"),$e=null,ge(),ke=null,Fe&&Fe.hide())}function pe(){Ye=!0}function ge(){Ye=!1}function de(){return Ye}function ue(e,t,a){!p.opts.htmlUntouched&&p.opts.useClasses?(e.removeClass("fr-fil fr-fir fr-dib fr-dii"),a&&e.addClass("fr-fi"+a[0]),t&&e.addClass("fr-di"+t[0])):"inline"==t?(e.css({display:"inline-block",verticalAlign:"bottom",margin:p.opts.imageDefaultMargin}),"center"==a?e.css({"float":"none",marginBottom:"",marginTop:"",maxWidth:"calc(100% - "+2*p.opts.imageDefaultMargin+"px)",textAlign:"center"}):"left"==a?e.css({"float":"left",marginLeft:0,maxWidth:"calc(100% - "+p.opts.imageDefaultMargin+"px)",textAlign:"left"}):e.css({"float":"right",marginRight:0,maxWidth:"calc(100% - "+p.opts.imageDefaultMargin+"px)",textAlign:"right"})):"block"==t&&(e.css({display:"block","float":"none",verticalAlign:"top",margin:p.opts.imageDefaultMargin+"px auto",textAlign:"center"}),"left"==a?e.css({marginLeft:0,textAlign:"left"}):"right"==a&&e.css({marginRight:0,textAlign:"right"}))}function ce(e){var t=Se();t.removeClass("fr-fir fr-fil"),!p.opts.htmlUntouched&&p.opts.useClasses?"left"==e?t.addClass("fr-fil"):"right"==e&&t.addClass("fr-fir"):ue(t,he(),e),Ce(),l(),r(),p.selection.clear()}function me(e){if(void 0===e&&(e=Se()),e){if(e.hasClass("fr-fil"))return"left";if(e.hasClass("fr-fir"))return"right";if(e.hasClass("fr-dib")||e.hasClass("fr-dii"))return"center";var t=e.css("float");if(e.css("float","none"),"block"==e.css("display")){if(e.css("float",""),e.css("float")!=t&&e.css("float",t),0===parseInt(e.css("margin-left"),10))return"left";if(0===parseInt(e.css("margin-right"),10))return"right"}else{if(e.css("float",""),e.css("float")!=t&&e.css("float",t),"left"==e.css("float"))return"left";if("right"==e.css("float"))return"right"}}return"center"}function he(e){void 0===e&&(e=Se());var t=e.css("float");return e.css("float","none"),"block"==e.css("display")?(e.css("float",""),e.css("float")!=t&&e.css("float",t),"block"):(e.css("float",""),e.css("float")!=t&&e.css("float",t),"inline")}function ve(e){$e&&e.find("> *:first").replaceWith(p.icon.create("image-align-"+me()))}function be(e,t){$e&&t.find('.fr-command[data-param1="'+me()+'"]').addClass("fr-active").attr("aria-selected",!0)}function ye(e){var t=Se();t.removeClass("fr-dii fr-dib"),!p.opts.htmlUntouched&&p.opts.useClasses?"inline"==e?t.addClass("fr-dii"):"block"==e&&t.addClass("fr-dib"):ue(t,e,me()),Ce(),l(),r(),p.selection.clear()}function we(e,t){$e&&t.find('.fr-command[data-param1="'+he()+'"]').addClass("fr-active").attr("aria-selected",!0)}function Ee(){var e=p.popups.get("image.insert");e||(e=M()),p.popups.isVisible("image.insert")||(y(),p.popups.refresh("image.insert"),p.popups.setContainer("image.insert",p.$sc));var t=Se();xe()&&(t=t.find(".fr-img-wrap"));var a=t.offset().left+t.outerWidth()/2,i=t.offset().top+t.outerHeight();p.popups.show("image.insert",a,i,t.outerHeight(!0))}function Ce(){if($e){p.events.disableBlur(),p.selection.clear();var e=p.doc.createRange();e.selectNode($e.get(0)),p.selection.get().addRange(e),p.events.enableBlur()}}function Ae(){$e?(p.events.disableBlur(),Xe(".fr-popup input:focus").blur(),C($e)):(p.events.disableBlur(),p.selection.restore(),p.events.enableBlur(),p.popups.hide("image.insert"),p.toolbar.showInline())}function Re(){return $e}function Se(){return xe()?$e.parents(".fr-img-caption:first"):$e}function De(e,t,a){if(void 0===t&&(t=p.opts.imageStyles),void 0===a&&(a=p.opts.imageMultipleStyles),!$e)return!1;var i=Se();if(!a){var r=Object.keys(t);r.splice(r.indexOf(e),1),i.removeClass(r.join(" "))}"object"==typeof t[e]?(i.removeAttr("style"),i.css(t[e].style)):i.toggleClass(e),C($e)}function xe(){return!!$e&&0<$e.parents(".fr-img-caption").length}function Ue(){var e;$e&&!xe()?((e=$e).parent().is("a")&&(e=$e.parent()),e.wrap("<span "+(p.browser.mozilla?"":'contenteditable="false"')+'class="fr-img-caption '+$e.attr("class")+'" style="'+($e.attr("style")?$e.attr("style")+" ":"")+"width: "+$e.width()+'px;" draggable="false"></span>'),e.wrap('<span class="fr-img-wrap"></span>'),e.after('<span class="fr-inner" contenteditable="true">'+Xe.FE.START_MARKER+"Image caption"+Xe.FE.END_MARKER+"</span>"),$e.removeAttr("class").removeAttr("style").removeAttr("width"),fe(!0),p.selection.restore()):(e=Se(),$e.insertAfter(e),$e.attr("class",e.attr("class").replace("fr-img-caption","")).attr("style",e.attr("style")),e.remove(),C($e))}var $e,Ie,ke,Fe,Be=!1,Pe=1,Oe=2,Ne=3,Te=4,Me=5,Le=6,ze=7,_e=8,We={};We[Pe]="Image cannot be loaded from the passed link.",We[Oe]="No link in upload response.",We[Ne]="Error during file upload.",We[Te]="Parsing response failed.",We[Me]="File is too large.",We[Le]="Image file type is invalid.",We[ze]="Files can be uploaded only to same domain in IE 8 and IE 9.",We[_e]="Image file is corrupted.";var Ke,He,Ye=!1;return{_init:te,showInsertPopup:a,showLayer:j,refreshUploadButton:G,refreshByURLButton:q,upload:B,insertByURL:e,align:ce,refreshAlign:ve,refreshAlignOnShow:be,display:ye,refreshDisplayOnShow:we,replace:Ee,back:Ae,get:Re,getEl:Se,insert:R,showProgressBar:b,remove:J,hideProgressBar:y,applyStyle:De,showAltPopup:z,showSizePopup:H,setAlt:W,setSize:X,toggleCaption:Ue,hasCaption:xe,exitEdit:fe,edit:C}},Xe.FE.DefineIcon("insertImage",{NAME:"image"}),Xe.FE.RegisterShortcut(Xe.FE.KEYCODE.P,"insertImage",null,"P"),Xe.FE.RegisterCommand("insertImage",{title:"Insert Image",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("image.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("image.insert")):this.image.showInsertPopup()},plugin:"image"}),Xe.FE.DefineIcon("imageUpload",{NAME:"upload"}),Xe.FE.RegisterCommand("imageUpload",{title:"Upload Image",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-upload")},refresh:function(e){this.image.refreshUploadButton(e)}}),Xe.FE.DefineIcon("imageByURL",{NAME:"link"}),Xe.FE.RegisterCommand("imageByURL",{title:"By URL",undo:!1,focus:!1,toggle:!0,callback:function(){this.image.showLayer("image-by-url")},refresh:function(e){this.image.refreshByURLButton(e)}}),Xe.FE.RegisterCommand("imageInsertByURL",{title:"Insert Image",undo:!0,refreshAfterCallback:!1,callback:function(){this.image.insertByURL()},refresh:function(e){this.image.get()?e.text(this.language.translate("Replace")):e.text(this.language.translate("Insert"))}}),Xe.FE.DefineIcon("imageDisplay",{NAME:"star"}),Xe.FE.RegisterCommand("imageDisplay",{title:"Display",type:"dropdown",options:{inline:"Inline",block:"Break Text"},callback:function(e,t){this.image.display(t)},refresh:function(e){this.opts.imageTextNear||e.addClass("fr-hidden")},refreshOnShow:function(e,t){this.image.refreshDisplayOnShow(e,t)}}),Xe.FE.DefineIcon("image-align",{NAME:"align-left"}),Xe.FE.DefineIcon("image-align-left",{NAME:"align-left"}),Xe.FE.DefineIcon("image-align-right",{NAME:"align-right"}),Xe.FE.DefineIcon("image-align-center",{NAME:"align-justify"}),Xe.FE.DefineIcon("imageAlign",{NAME:"align-justify"}),Xe.FE.RegisterCommand("imageAlign",{type:"dropdown",title:"Align",options:{left:"Align Left",center:"None",right:"Align Right"},html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=Xe.FE.COMMANDS.imageAlign.options;for(var a in t)t.hasOwnProperty(a)&&(e+='<li role="presentation"><a class="fr-command fr-title" tabIndex="-1" role="option" data-cmd="imageAlign" data-param1="'+a+'" title="'+this.language.translate(t[a])+'">'+this.icon.create("image-align-"+a)+'<span class="fr-sr-only">'+this.language.translate(t[a])+"</span></a></li>");return e+"</ul>"},callback:function(e,t){this.image.align(t)},refresh:function(e){this.image.refreshAlign(e)},refreshOnShow:function(e,t){this.image.refreshAlignOnShow(e,t)}}),Xe.FE.DefineIcon("imageReplace",{NAME:"exchange",FA5NAME:"exchange-alt"}),Xe.FE.RegisterCommand("imageReplace",{title:"Replace",undo:!1,focus:!1,popup:!0,refreshAfterCallback:!1,callback:function(){this.image.replace()}}),Xe.FE.DefineIcon("imageRemove",{NAME:"trash"}),Xe.FE.RegisterCommand("imageRemove",{title:"Remove",callback:function(){this.image.remove()}}),Xe.FE.DefineIcon("imageBack",{NAME:"arrow-left"}),Xe.FE.RegisterCommand("imageBack",{title:"Back",undo:!1,focus:!1,back:!0,callback:function(){this.image.back()},refresh:function(e){this.image.get()||this.opts.toolbarInline?(e.removeClass("fr-hidden"),e.next(".fr-separator").removeClass("fr-hidden")):(e.addClass("fr-hidden"),e.next(".fr-separator").addClass("fr-hidden"))}}),Xe.FE.RegisterCommand("imageDismissError",{title:"OK",undo:!1,callback:function(){this.image.hideProgressBar(!0)}}),Xe.FE.DefineIcon("imageStyle",{NAME:"magic"}),Xe.FE.RegisterCommand("imageStyle",{title:"Style",type:"dropdown",html:function(){var e='<ul class="fr-dropdown-list" role="presentation">',t=this.opts.imageStyles;for(var a in t)if(t.hasOwnProperty(a)){var i=t[a];"object"==typeof i&&(i=i.title),e+='<li role="presentation"><a class="fr-command" tabIndex="-1" role="option" data-cmd="imageStyle" data-param1="'+a+'">'+this.language.translate(i)+"</a></li>"}return e+"</ul>"},callback:function(e,t){this.image.applyStyle(t)},refreshOnShow:function(e,t){var a=this.image.getEl();a&&t.find(".fr-command").each(function(){var e=Xe(this).data("param1"),t=a.hasClass(e);Xe(this).toggleClass("fr-active",t).attr("aria-selected",t)})}}),Xe.FE.DefineIcon("imageAlt",{NAME:"info"}),Xe.FE.RegisterCommand("imageAlt",{undo:!1,focus:!1,popup:!0,title:"Alternate Text",callback:function(){this.image.showAltPopup()}}),Xe.FE.RegisterCommand("imageSetAlt",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setAlt()}}),Xe.FE.DefineIcon("imageSize",{NAME:"arrows-alt"}),Xe.FE.RegisterCommand("imageSize",{undo:!1,focus:!1,popup:!0,title:"Change Size",callback:function(){this.image.showSizePopup()}}),Xe.FE.RegisterCommand("imageSetSize",{undo:!0,focus:!1,title:"Update",refreshAfterCallback:!1,callback:function(){this.image.setSize()}}),Xe.FE.DefineIcon("imageCaption",{NAME:"commenting",FA5NAME:"comment-alt"}),Xe.FE.RegisterCommand("imageCaption",{undo:!0,focus:!1,title:"Image Caption",refreshAfterCallback:!0,callback:function(){this.image.toggleCaption()},refresh:function(e){this.image.get()&&e.toggleClass("fr-active",this.image.hasCaption())}})});